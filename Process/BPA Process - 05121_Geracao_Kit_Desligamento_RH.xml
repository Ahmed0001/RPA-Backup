<process name="05121_Geracao_Kit_Desligamento_RH" version="1.0" bpversion="7.0.0.40580" narrative="" byrefcollection="true" preferredid="6cc8fd1f-c36e-43f4-acf8-03e28a9d3c38">
  <view>
    <camerax>-126</camerax>
    <cameray>179</cameray>
    <zoom version="2">1.875</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="c3a06f9b-8b94-40a9-ae89-d1314f4004b4" type="Normal" published="False">
    <name>Start Up</name>
    <view>
      <camerax>52</camerax>
      <cameray>150</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="141bd1a8-b3db-4b6d-abc0-530e42fbd66d" type="Normal" published="False">
    <name>APP1 - Minha Via</name>
    <view>
      <camerax>0</camerax>
      <cameray>-33</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="902b1f5d-41c6-4133-8824-908cffd0cfa3" type="Normal" published="False">
    <name>APP2 - SAP - Acess Transction</name>
    <view>
      <camerax>62</camerax>
      <cameray>-78</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c694c8c2-0e99-4e47-8381-768d45ad209a" type="Normal" published="False">
    <name>1.0 - Create Folder ID</name>
    <view>
      <camerax>8</camerax>
      <cameray>-165</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="52955815-5669-4aa5-a7b9-d5ce7ac77aa1" type="Normal" published="False">
    <name>2.0 - Download Documents</name>
    <view>
      <camerax>15</camerax>
      <cameray>150</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="12a17449-7e72-40ac-9f5c-3ab2c498c5af" type="Normal" published="False">
    <name>2.1 - Select Documentos Postgre SQL</name>
    <view>
      <camerax>390</camerax>
      <cameray>576</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="acddfbca-7d9c-429a-bd93-bbdcae28f3f1" type="Normal" published="False">
    <name>2.2 - Insert User</name>
    <view>
      <camerax>154</camerax>
      <cameray>-9</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="562f28c5-23b6-4e34-91db-68c96585f0fd" type="Normal" published="False">
    <name>2.3 - Insert Model</name>
    <view>
      <camerax>-22</camerax>
      <cameray>15</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="9e0f57ec-f060-4d75-9743-b787b11d4d46" type="Normal" published="False">
    <name>2.4 - Directory Checker</name>
    <view>
      <camerax>44</camerax>
      <cameray>135</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="60d66175-084d-4059-90a9-02368c860d5a" type="Normal" published="False">
    <name>2.5 - SAP_DAP</name>
    <view>
      <camerax>15</camerax>
      <cameray>26</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="6e7a8a41-35f8-4414-af93-40472565e079" type="Normal" published="False">
    <name>3 - Move To Exception Folder</name>
    <view>
      <camerax>-105</camerax>
      <cameray>447</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7d5a12a1-3f3d-4808-a3c4-f619218b2a67" type="Normal" published="False">
    <name>Update PostgreSql</name>
    <view>
      <camerax>-49</camerax>
      <cameray>-270</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="325a4f14-9840-42e5-95ad-c38be9fca219" type="Normal" published="False">
    <name>Mark Item As Completed</name>
    <view>
      <camerax>-150</camerax>
      <cameray>-120</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7025041b-a2e5-4baa-a406-07c849995dc8" type="Normal" published="False">
    <name>Mark Item As Exception</name>
    <view>
      <camerax>158</camerax>
      <cameray>12</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="262f4593-de70-4c91-a3fb-13dc05264101" type="Normal" published="False">
    <name>Note message</name>
    <view>
      <camerax>-67</camerax>
      <cameray>0</cameray>
      <zoom version="2">2.5</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce" type="Normal" published="False">
    <name>Delete Folder</name>
    <view>
      <camerax>8</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.875</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="146132fd-3da0-450f-9ab8-9e0828e4d6c2" type="Normal" published="False">
    <name>Reset Global Data</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4531fc13-a734-42d7-a055-0248921d4428" type="Normal" published="False">
    <name>Teams Message Informativos</name>
    <view>
      <camerax>0</camerax>
      <cameray>21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="838ed262-8e29-4c96-80e3-81eeeb98babd" type="Normal" published="False">
    <name>Close</name>
    <view>
      <camerax>0</camerax>
      <cameray>165</cameray>
      <zoom version="2">2.1875</zoom>
    </view>
  </subsheet>
  <stage stageid="08fe9789-8f62-47a4-8e40-342e374ffb9e" name="Start" type="Start">
    <display x="75" y="135" />
    <onsuccess>8eb74a21-1970-4149-be96-9b10edd3c3f7</onsuccess>
  </stage>
  <stage stageid="d84bc8fe-2be2-46c0-8bf0-769ca2efd860" name="End" type="End">
    <display x="495" y="135" />
  </stage>
  <stage stageid="e817c4c2-a496-4fdf-a1e7-6eaf0f2e181c" name="Stage1" type="ProcessInfo">
    <display x="-225" y="165" w="330" h="90" />
  </stage>
  <stage stageid="bf0e564f-7434-43d4-ab2d-fc36df63507a" name="Item ID" type="Data">
    <display x="-135" y="765" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="d4fb5bed-1a08-4616-9dfd-a7347e95bdd7" name="Status Q" type="Data">
    <display x="-135" y="735" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="10ad4f24-721d-4c3b-a8da-3eb68d59413e" name="Attempts" type="Data">
    <display x="-135" y="795" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="8f6d5153-8d57-47f7-aef3-29930177d4e2" name="Output Work Queue" type="Block">
    <display x="-210" y="645" w="150" h="180" />
    <font family="Segoe UI" size="10" style="Bold" color="FF00FF" />
  </stage>
  <stage stageid="3011a661-a6aa-44e0-b370-93f332664e83" name="Queue Name" type="Data">
    <display x="-135" y="600" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="6b7bcf55-1a77-437d-87b8-f84863b916c0" name="Work Queue" type="Block">
    <display x="-210" y="570" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="0000FF" />
  </stage>
  <stage stageid="577b1587-d017-4538-872c-65c319983ee8" name="Times" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-390" y="225" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="c3442b42-56fc-4813-8b7c-2297ce783005" name="str_endTime" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="300" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="f41ef907-c566-4fea-87a7-59e8eda26841" name="Start Up" type="SubSheetInfo">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="-195" y="-240" w="150" h="90" />
  </stage>
  <stage stageid="945a85db-2b55-4347-b355-3613c43bf9c0" name="Start" type="Start">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="15" y="-270" />
    <onsuccess>49d89e50-d8dd-4a96-9c4e-1b11badcf3d7</onsuccess>
  </stage>
  <stage stageid="07976e62-f7ed-4e4f-8f86-4d4586bb959e" name="Anchor1" type="Anchor">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" w="10" h="10" />
    <onsuccess>3dc714ee-deab-42e9-9b03-ef5465105278</onsuccess>
  </stage>
  <stage stageid="86c77953-5e0d-4c2c-b116-0746ac97a6c1" name="Resume" type="Resume">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit />
    <display x="120" y="-135" />
    <onsuccess>07976e62-f7ed-4e4f-8f86-4d4586bb959e</onsuccess>
  </stage>
  <stage stageid="185b8d74-7c7b-489f-9c22-f7c7d3732202" name="Recover" type="Recover">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit />
    <display x="120" y="-60" />
    <onsuccess>ad162359-9ec7-4c37-a8a0-c6d140aee875</onsuccess>
  </stage>
  <stage stageid="cf790369-1070-4bc1-9f78-9d2ab2aedc56" name="Retry count" type="Data">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-150" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="42eecb4d-2f39-4f61-811b-b0e4cf6a9e5b" name="Retry Limit" type="Data">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-120" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>3</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="65b48d9a-5ac0-4fb7-9e3f-96ed3810f4b5" name="Treatment And Exceptions" type="Block">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-180" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="ad162359-9ec7-4c37-a8a0-c6d140aee875" name="Retry" type="Decision">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="225" y="-60" w="90" h="30" />
    <decision expression="[Retry count]&lt;[Retry Limit]" />
    <ontrue>8bce3d0e-2992-4e5f-b8bd-4ff89771591f</ontrue>
    <onfalse>44852b6f-ad90-43c5-8e18-7f0d8e78ba0c</onfalse>
  </stage>
  <stage stageid="8bce3d0e-2992-4e5f-b8bd-4ff89771591f" name="Count ++" type="Calculation">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="-135" />
    <onsuccess>86c77953-5e0d-4c2c-b116-0746ac97a6c1</onsuccess>
    <calculation expression="[Retry count]+1" stage="Retry count" />
  </stage>
  <stage stageid="44852b6f-ad90-43c5-8e18-7f0d8e78ba0c" name="Throw" type="Exception">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="330" y="-60" />
    <exception localized="yes" type="Business Exception" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="60a34ed4-b6a0-4e0c-b565-b64a2ecf3b19" name="APP1 - MINHA VIA" type="Block">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-105" w="225" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="74975820-4121-43f5-b8c7-130654dc6cb0" name="End" type="End">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="15" y="315" />
  </stage>
  <stage stageid="72bd99a3-71f8-4fac-8ba3-9e2b371a73a6" name="Mark Item As Completed" type="SubSheetInfo">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-225" y="-270" w="150" h="90" />
  </stage>
  <stage stageid="64812acd-b120-449a-adf4-fdda575982c1" name="Start" type="Start">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-45" y="-300" />
    <onsuccess>a68d4eea-37c4-43b4-88e2-c8626127f58e</onsuccess>
  </stage>
  <stage stageid="db635ed2-8e28-4523-b8a7-5f3362477fa6" name="End" type="End">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-45" y="120" />
  </stage>
  <stage stageid="92a273ff-a150-4d1c-9f0e-ad2d2cfbd1dc" name="Update Status" type="Action">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative>
    <display x="-45" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="[str_status]" />
      <input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
    </inputs>
    <onsuccess>06907f21-3df2-4e03-878d-941e70045c9b</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" />
  </stage>
  <stage stageid="cda68c63-8072-474f-bbb2-0a903cb06822" name="str_status" type="Data">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-225" y="-180" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c497b529-49f6-486f-b806-e30c9e17a6ef" name="Input Update" type="Block">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-300" y="-210" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
  </stage>
  <stage stageid="06907f21-3df2-4e03-878d-941e70045c9b" name="Mark Completed" type="Action">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="-45" y="60" w="90" h="30" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
    </inputs>
    <onsuccess>db635ed2-8e28-4523-b8a7-5f3362477fa6</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" />
  </stage>
  <stage stageid="84703d8e-48b9-4393-85c8-21b5bb095709" name="Mark Item As Completed" type="SubSheetInfo">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="-195" w="150" h="90" />
  </stage>
  <stage stageid="8d58046b-93bc-4d9f-bc31-1c2b19d85ee3" name="Start" type="Start">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="-225" />
    <onsuccess>586139ad-1b61-4d8c-a93c-801bbbaf26bd</onsuccess>
  </stage>
  <stage stageid="090fc7b2-481f-46af-9ecd-76facd6916d7" name="End" type="End">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="720" />
  </stage>
  <stage stageid="3fc6610e-7e46-40bf-be65-30ac7217825a" name="Status" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="-105" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Exception</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="12388b38-9e5a-4e66-aa9d-0662a4e59c36" name="Input Update" type="Block">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-165" y="-135" w="150" h="315" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e7680ba2-6023-4075-bd75-3275eb4c2729" name="Close" type="SubSheetInfo">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="7846199b-8017-42e9-9297-1b4102f51bd9" name="Start" type="Start">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>379c106c-6f86-4cf6-82a6-ac8071ea9742</onsuccess>
  </stage>
  <stage stageid="18f9b3bc-66fe-4d33-ac62-8cf1ad69a5c7" name="End" type="End">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <display x="15" y="165" />
  </stage>
  <stage stageid="5cf399c4-7c49-40ab-8f9a-dc9de559958f" name="Kill Process Chrome" type="Action">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="&quot;chrome&quot;" />
    </inputs>
    <onsuccess>2a4f47aa-4928-46a1-949e-5e8456f5804f</onsuccess>
    <resource object="Utility - Environment" action="Kill Process" />
  </stage>
  <stage stageid="0240232b-e389-4435-b060-3222c2279d2e" name="Kill Process SAP" type="Action">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="105" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="[str_applicationSap]" />
    </inputs>
    <onsuccess>18f9b3bc-66fe-4d33-ac62-8cf1ad69a5c7</onsuccess>
    <resource object="Utility - Environment" action="Kill Process" />
  </stage>
  <stage stageid="379c106c-6f86-4cf6-82a6-ac8071ea9742" name="Terminate Minha VIA" type="Action">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <onsuccess>5cf399c4-7c49-40ab-8f9a-dc9de559958f</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="Terminate" />
  </stage>
  <stage stageid="9119bd14-5700-439c-a363-a85befb9da8c" name="2.0 - Download Documents" type="SubSheetInfo">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="-225" y="-255" w="150" h="90" />
  </stage>
  <stage stageid="47a97908-dcef-4076-a93d-e8b7744f0712" name="Start" type="Start">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="15" y="-285" />
    <onsuccess>3890138f-fa5d-484b-9122-57250e31999c</onsuccess>
  </stage>
  <stage stageid="250c578e-7467-4db5-a0d2-a76c9275f58e" name="End" type="End">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="15" y="495" />
  </stage>
  <stage stageid="fb016371-0d41-4a4b-89eb-df9435aabbd4" name="1.0 - Create Folder ID" type="SubSheetInfo">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-195" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="b42e5879-985e-46d4-9cc6-91d8adeab5bb" name="Start" type="Start">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-30" y="-240" />
    <onsuccess>d87c2002-a65f-4db1-95bd-24dd265f65bb</onsuccess>
  </stage>
  <stage stageid="a46277ce-bb39-495b-a7f7-1ff866df082c" name="End" type="End">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-30" y="345" />
  </stage>
  <stage stageid="143014ef-738e-4fbf-b496-8ebff94c521d" name="Local Variables" type="Block">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="-300" y="-195" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
  </stage>
  <stage stageid="5c42fe22-0157-4e86-8729-303294f73e19" name="Create Directory" type="Action">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="195" />
    <inputs>
      <input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[str_pathUsuarioAtual]" />
      <input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_success" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>29508c84-d954-43f0-a96f-a870a28fb89a</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="54a1cd65-691c-4439-9309-3644b4804db1" name="nome_pasta" type="Data">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="54754aa9-1ad7-4ce6-abfc-906d17190d10" name="Local Variables" type="Block">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit />
    <display x="-270" y="-150" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="7f6a222b-792e-4d62-8765-fb46aa01372c" name="Get Next Item" type="Action">
    <narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative>
    <display x="75" y="300" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" />
      <output type="text" name="Status" narrative="The status of the item." stage="Status Q" />
      <output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Attempts" />
    </outputs>
    <onsuccess>8f04db06-ddb0-4fae-b262-200339661abd</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="8f04db06-ddb0-4fae-b262-200339661abd" name="Item Exist ?" type="Decision">
    <display x="180" y="300" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <decision expression="[Item ID]&lt;&gt;&quot;&quot;" />
    <ontrue>73d85687-c7e5-49b1-895f-3e8507fc493a</ontrue>
    <onfalse>4e4e3cef-ec1f-447f-af2f-be1194621ea4</onfalse>
  </stage>
  <stage stageid="8eb74a21-1970-4149-be96-9b10edd3c3f7" name="Start Up" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="75" y="210" w="90" h="60" />
    <onsuccess>7f6a222b-792e-4d62-8765-fb46aa01372c</onsuccess>
    <processid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</processid>
  </stage>
  <stage stageid="8ecc746a-aea1-461c-8f2d-85f44a03bb9a" name="Work" type="Block">
    <display x="120" y="345" w="120" h="225" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9d8e1d49-8dc0-4cfc-9c35-2697b7f81e26" name="Recover Work" type="Recover">
    <display x="180" y="540" />
    <onsuccess>cf9d815f-bbbb-4d4d-bc50-dab44cf6870d</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="3659fa50-e504-42e9-b1a5-2d180f9b50f0" name="Resume Work" type="Resume">
    <display x="180" y="690" />
    <onsuccess>754ef9f3-e199-4309-88ff-e7fa45025632</onsuccess>
  </stage>
  <stage stageid="cf9d815f-bbbb-4d4d-bc50-dab44cf6870d" name="Get Exception" type="MultipleCalculation">
    <display x="180" y="615" w="90" h="60" />
    <onsuccess>3659fa50-e504-42e9-b1a5-2d180f9b50f0</onsuccess>
    <steps>
      <calculation expression="ExceptionType()" stage="Exception Type" />
      <calculation expression="ExceptionDetail()" stage="Exception Detail" />
    </steps>
  </stage>
  <stage stageid="73d85687-c7e5-49b1-895f-3e8507fc493a" name="1.0 - Create Folder ID" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="180" y="390" w="90" h="60" />
    <onsuccess>ea2e3828-1f43-4e04-bc88-d629b46fac61</onsuccess>
    <processid>c694c8c2-0e99-4e47-8381-768d45ad209a</processid>
  </stage>
  <stage stageid="11ad9017-004e-4e0d-a20b-dda308b5939b" name="2.1 - Select Documentos Postgre SQL" type="SubSheetInfo">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="-240" w="150" h="90" />
  </stage>
  <stage stageid="6f204d53-51dd-41a1-b300-89ee2c1d47b1" name="Start" type="Start">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="180" y="-435" />
    <onsuccess>d666147a-2f86-4a34-9466-76ebd2416044</onsuccess>
  </stage>
  <stage stageid="f1cf6533-ab24-484e-9418-1a0bac472959" name="End" type="End">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="300" y="795" />
  </stage>
  <stage stageid="db810a62-09a6-4319-988e-4594c3a65a65" name="Data - ODBC::Open" type="Action">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="495" w="90" h="30" />
    <inputs>
      <input type="text" name="Connection String" friendlyname="Connection String" narrative="The ODBC connection stirng for your specific data source." expr="[PROVIDER]" />
    </inputs>
    <outputs>
      <output type="flag" name="Status" friendlyname="Status" narrative="Flag indicating success or failure of the Open operation. True if the connection was successfully opened. Otherwise, False." stage="STATUS_CONEX" />
      <output type="text" name="Message" friendlyname="Message" narrative="If an error was encountered, this parameter will contain that message." stage="MESSAGE_CONEX" />
    </outputs>
    <onsuccess>3132c4fc-c375-4ab4-b12c-815afae2a156</onsuccess>
    <resource object="Data - ODBC" action="Open" />
  </stage>
  <stage stageid="3132c4fc-c375-4ab4-b12c-815afae2a156" name="Execute Query" type="Action">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="555" w="90" h="30" />
    <inputs>
      <input type="text" name="Query String" friendlyname="Query String" narrative="The query statement to execute against the ODBC data source." expr="[QUERY]" />
    </inputs>
    <outputs>
      <output type="flag" name="Status" friendlyname="Status" narrative="A flag indicate success (True) or failure (False) of the action." stage="STATUS_QUERY" />
      <output type="text" name="Message" friendlyname="Message" narrative="If an error occurs, any message will be found in this data item." stage="MESSAGE_QUERY" />
      <output type="collection" name="Results" friendlyname="Results" narrative="Collection contaning the results of the query." stage="Lista Documentos" />
    </outputs>
    <onsuccess>e1cefba6-124e-4dd9-b013-cc451d2ded59</onsuccess>
    <resource object="Data - ODBC" action="Execute" />
  </stage>
  <stage stageid="e1cefba6-124e-4dd9-b013-cc451d2ded59" name="Data - ODBC::Close" type="Action">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="615" w="90" h="30" />
    <onsuccess>5b93e0d3-e1ba-40a0-9373-522413680636</onsuccess>
    <resource object="Data - ODBC" action="Close" />
  </stage>
  <stage stageid="430cb953-b115-433b-b6c8-350310d21021" name="Provider Input" type="Block">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-180" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="993300" />
  </stage>
  <stage stageid="d29d3656-e4bb-40b5-8edf-15b8cd653a55" name="PROVIDER" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="135" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="60d29020-73aa-490f-8cb4-97d7650d50c1" name="Provider Output" type="Block">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="105" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4e5fb0bc-052c-4355-acd4-a6cd2bd24744" name="STATUS_CONEX" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="195" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a92d66b5-25bc-4a2c-8a13-97cfe2e42dc7" name="MESSAGE_CONEX" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="165" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fcff3fac-c2f0-4640-a5d8-1a42e23082ce" name="Query" type="Block">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="240" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="65657cc2-2400-4143-8305-20ec424dc21b" name="STATUS_QUERY" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="330" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1f421062-2ca2-40b0-8e88-c0fe969be355" name="MESSAGE_QUERY" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="300" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4daa9d82-f212-47fb-8d36-247f510582b8" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="255" />
    <onsuccess>c79dc02a-e24e-4dab-a94f-e1ea046b906a</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN ('ORIENTACOES',&#xA;                    'RETIRADA_CARNE', &#xA;                    'TERMO_DEV_NOTEBOOK',&#xA;                    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;                    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="c77f5dfe-721c-459c-af69-a39ed14fccf2" name="QUERY" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="270" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="66dd0f8d-ef73-45f4-ac39-fdd2de8bd640" name="Input Query" type="Block">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="375" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b1245a8e-b612-40d9-aa5a-18cc4216ac03" name="ID Matricula" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="480" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">445010</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f1daa717-929b-43d4-b05e-c5451240d145" name="Server" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="33a2271e-c5b6-4028-8f9b-aca5a7953832" name="Port" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="727e51cf-3830-4f94-af7a-247b76b584ab" name="Database" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="da6b6e4d-41d3-4e24-8820-80b5dcd099b9" name="Password" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="60" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d4f50993-f538-4016-9603-eada3d2628eb" name="Username" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="68880ab4-fd7d-463e-9116-e5e59a28091d" name="Motivo" type="ChoiceStart">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="60" y="-165" w="90" h="30" />
    <groupid>7655b65a-0cb7-4f49-887e-4d147c366f1d</groupid>
    <choices>
      <choice expression="InStr([Item Data.motivo do evento], &quot;40&quot;) &lt;&gt; 0 AND&#xA;Lower([Item Data.detalhes do emprego aviso previo]) = &quot;nao desconta&quot;&#xA;">
        <name>40-PEDIDO DEMISSAO NÃO DESCONTA</name>
        <distance>60</distance>
        <ontrue>f8833dc2-b86b-4d58-9942-2d72dc5e3a9f</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;40&quot;) &lt;&gt; 0 &#xA;AND &#xA;Lower([Item Data.detalhes do emprego aviso previo]) = &quot;desconta&quot;&#xA;&#xA;&#xA;">
        <name>40-PEDIDO DEMISSAO DESCONTA</name>
        <distance>120</distance>
        <ontrue>9e5bf22e-4621-446a-91b4-b2dcdb9f8adc</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;40&quot;) &lt;&gt; 0 AND &#xA;Lower([Item Data.detalhes do emprego aviso previo]) = &quot;trabalhado&quot;&#xA;&#xA;">
        <name>40-PEDIDO DEMISSAO - TRABALHADO</name>
        <distance>180</distance>
        <ontrue>d38fb5b0-fd4a-4392-8966-6439fc724397</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;29&quot;) &lt;&gt; 0  AND &#xA;Lower([Item Data.detalhes do emprego aviso previo]) = &quot;trabalhado&quot;&#xA;">
        <name>29-RESCISAO SEM JUSTA CAUSA -  TRABALHADO</name>
        <distance>240</distance>
        <ontrue>274434ce-1110-413d-ad80-7eb7efff7bbf</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;29&quot;) &lt;&gt; 0 AND&#xA;Lower([Item Data.detalhes do emprego aviso previo]) = &quot;indenizado&quot;&#xA;&#xA;">
        <name>29-RESCISAO SEM JUSTA CAUSA - INDENIZADO</name>
        <distance>300</distance>
        <ontrue>0aa2998b-cfad-4caf-9131-56f65a6f636e</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;62&quot;) &lt;&gt; 0">
        <name>62-RESCISAO SEM JUSTA CAUSA (INTERMITENTE)</name>
        <distance>360</distance>
        <ontrue>077b49f7-02d5-47c8-8cf1-985b3b0c1e01</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;37&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;60&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;32&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;36&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;34&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;39&quot;) &lt;&gt; 0&#xA;">
        <name>Grupo 1</name>
        <distance>420</distance>
        <ontrue>4daa9d82-f212-47fb-8d36-247f510582b8</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;63&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;28&quot;) &lt;&gt; 0">
        <name>Grupo 2</name>
        <distance>480</distance>
        <ontrue>5692173b-eeec-43cf-86cb-bda27cc43599</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;31&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;61&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;35&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;48&quot;) &lt;&gt; 0&#xA;OR&#xA;InStr([Item Data.motivo do evento], &quot;46&quot;) &lt;&gt; 0&#xA;&#xA;&#xA;&#xA;">
        <name>Grupo 3</name>
        <distance>540</distance>
        <ontrue>e6e7a145-e395-4f6e-baba-6bd4492f99e7</ontrue>
      </choice>
      <choice expression="InStr([Item Data.motivo do evento], &quot;45&quot;) &lt;&gt; 0 OR &#xA;InStr([Item Data.motivo do evento], &quot;30&quot;) &lt;&gt; 0 OR &#xA;InStr([Item Data.motivo do evento], &quot;33&quot;) &lt;&gt; 0 OR &#xA;InStr([Item Data.motivo do evento], &quot;47&quot;) &lt;&gt; 0">
        <name>Grupo 4</name>
        <distance>600</distance>
        <ontrue>a9df4f18-575e-4563-9962-990ab44ae9e4</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="d921cb07-ce1b-449d-94ad-52a4cd8f9b7c" name="!Pattern Found" type="ChoiceEnd">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="60" y="495" w="90" h="30" />
    <onsuccess>e2a72c72-d79b-4e46-9717-f20aa9586403</onsuccess>
    <groupid>7655b65a-0cb7-4f49-887e-4d147c366f1d</groupid>
  </stage>
  <stage stageid="076efb92-a4a5-4252-a527-fc7d9b38b1dc" name="Lista Documentos" type="Collection">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="-225" y="-150" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="number" />
      <field name="documento" type="text" />
      <field name="status" type="text" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="id" type="number" value="1" />
        <field name="documento" type="text" value="Feijao" />
        <field name="status" type="text" value="OK" />
      </row>
      <row>
        <field name="id" type="number" value="2" />
        <field name="documento" type="text" value="Arroz" />
        <field name="status" type="text" value="NOK" />
      </row>
      <row>
        <field name="id" type="number" value="3" />
        <field name="documento" type="text" value="Carne" />
        <field name="status" type="text" value="NOK" />
      </row>
      <row>
        <field name="id" type="number" value="4" />
        <field name="documento" type="text" value="Fuba " />
        <field name="status" type="text" value="OK" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="f490975b-c107-4ea0-a50e-17700138d076" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="135" w="10" h="10" />
    <onsuccess>0f5ccc08-dbcc-4b88-b7d7-9eb2d0466aa6</onsuccess>
  </stage>
  <stage stageid="274434ce-1110-413d-ad80-7eb7efff7bbf" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="75" />
    <onsuccess>77d80a55-1308-4445-8a0f-773426b0b3df</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS Status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN (&#xA;    'ORIENTACOES',&#xA;    'AVISO_DISP_SEM_JUSTA_CAUSA_TRABALHADO',&#xA;    'RETIRADA_CARNE',&#xA;    'TERMO_DEV_NOTEBOOK',&#xA;    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;    'ENCAMINHAMENTO_EXAME',&#xA;    'DAP')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="0aa2998b-cfad-4caf-9131-56f65a6f636e" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="135" />
    <onsuccess>f490975b-c107-4ea0-a50e-17700138d076</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS Status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN (&#xA;    'ORIENTACOES',&#xA;    'DISPENSA_SEM_JUSTA_CAUSA',&#xA;    'RETIRADA_CARNE',&#xA;    'TERMO_DEV_NOTEBOOK',&#xA;    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;    'ENCAMINHAMENTO_EXAME',&#xA;    'DAP')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="d38fb5b0-fd4a-4392-8966-6439fc724397" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="15" />
    <onsuccess>70aa10d8-e786-4cff-a649-5658a19fb9e8</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS Status&#xA;FROM tb_rh_kit_deslicamento_documento&#xA;WHERE documento IN (&#xA;    'ORIENTACOES',&#xA;    'PEDIDO_DEMISSAO_MODELO_CUMPRIMENTO_AVISO_PREVIO',&#xA;    'RETIRADA_CARNE',&#xA;    'TERMO_DEV_NOTEBOOK',&#xA;    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;    'ENCAMINHAMENTO_EXAME')&quot;" stage="QUERY" />
  </stage>
  <stage stageid="c79dc02a-e24e-4dab-a94f-e1ea046b906a" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="255" w="10" h="10" />
    <onsuccess>0e467595-9ca1-4771-99f0-ba930a05ab07</onsuccess>
  </stage>
  <stage stageid="77d80a55-1308-4445-8a0f-773426b0b3df" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="75" w="10" h="10" />
    <onsuccess>f490975b-c107-4ea0-a50e-17700138d076</onsuccess>
  </stage>
  <stage stageid="70aa10d8-e786-4cff-a649-5658a19fb9e8" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="15" w="10" h="10" />
    <onsuccess>77d80a55-1308-4445-8a0f-773426b0b3df</onsuccess>
  </stage>
  <stage stageid="3890138f-fa5d-484b-9122-57250e31999c" name="2.1 - Select Documentos Postgre SQL" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-210" w="90" h="60" />
    <onsuccess>a63a9224-1079-40fd-a454-53a77ce7fcf4</onsuccess>
    <processid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</processid>
  </stage>
  <stage stageid="ea2e3828-1f43-4e04-bc88-d629b46fac61" name="2.0 - Download Documents" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="180" y="480" w="90" h="60" />
    <onsuccess>1d0f7279-a8ed-4d75-82c5-db6712967101</onsuccess>
    <processid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</processid>
  </stage>
  <stage stageid="a038db39-4900-44ad-a8d0-405b25ec00b6" name="Documents" type="LoopStart">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <onsuccess>68aab87e-65cf-4aeb-a9f7-a495c434633c</onsuccess>
    <groupid>e6311b88-d3ba-4e94-a7f4-f6716f5b9778</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Lista Documentos</loopdata>
  </stage>
  <stage stageid="ab88773e-ef80-40b4-8dc6-e712510ae29e" name="Documents" type="LoopEnd">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="375" w="90" h="30" />
    <onsuccess>19b8a22b-12f0-4148-82cc-f02c7d2d6aba</onsuccess>
    <groupid>e6311b88-d3ba-4e94-a7f4-f6716f5b9778</groupid>
  </stage>
  <stage stageid="d00f5c7b-1174-4216-abfd-6f53ae700860" name="Reset Global Data" type="SubSheetInfo">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="3246057e-e0ac-4abb-ba99-239cb6607bb7" name="Start" type="Start">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>0165fbe1-4055-4c8f-b894-9a52aafd4ef3</onsuccess>
  </stage>
  <stage stageid="0165fbe1-4055-4c8f-b894-9a52aafd4ef3" name="End" type="End">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="15" y="90" />
  </stage>
  <stage stageid="80ed074c-5a17-4823-82d2-dd7779e9c71b" name="Exception Type" type="Data">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="9aa5b8db-f208-4f65-9678-095132a6bbd7" name="Exception Detail" type="Data">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="82e3ac2e-3234-41e7-a54c-1f88325d5d7f" name="Exception" type="Block">
    <subsheetid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</subsheetid>
    <display x="-270" y="-45" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="1d0f7279-a8ed-4d75-82c5-db6712967101" name="Mark Item As Completed" type="SubSheet">
    <display x="345" y="480" w="90" h="60" />
    <onsuccess>28d16b07-49ca-42fd-944d-cdb1d38a53da</onsuccess>
    <processid>325a4f14-9840-42e5-95ad-c38be9fca219</processid>
  </stage>
  <stage stageid="754ef9f3-e199-4309-88ff-e7fa45025632" name="Mark Item As Exception" type="SubSheet">
    <display x="345" y="690" w="90" h="60" />
    <onsuccess>a0a6dca9-2e7d-40d0-82fc-787f6e7a8cd2</onsuccess>
    <processid>7025041b-a2e5-4baa-a406-07c849995dc8</processid>
  </stage>
  <stage stageid="a0a6dca9-2e7d-40d0-82fc-787f6e7a8cd2" name="Anchor4" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="495" y="690" w="10" h="10" />
    <onsuccess>28d16b07-49ca-42fd-944d-cdb1d38a53da</onsuccess>
  </stage>
  <stage stageid="28d16b07-49ca-42fd-944d-cdb1d38a53da" name="Anchor5" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="495" y="480" w="10" h="10" />
    <onsuccess>bdf8ef56-cce4-4aee-8652-3fe7d9dd9817</onsuccess>
  </stage>
  <stage stageid="8d180fbf-bd0e-4911-ba8e-f59aec5bb072" name="Get Next Item" type="Action">
    <narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative>
    <display x="345" y="300" />
    <inputs>
      <input type="text" name="Queue Name" narrative="The name of the queue" expr="[Queue Name]" />
      <input type="text" name="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" narrative="The data associated with the item - a single collection row." stage="Item Data" />
      <output type="text" name="Status" narrative="The status of the item." stage="Status Q" />
      <output type="number" name="Attempts" narrative="The number of attempts already made to work this item." stage="Attempts" />
    </outputs>
    <onsuccess>8f04db06-ddb0-4fae-b262-200339661abd</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="bdf8ef56-cce4-4aee-8652-3fe7d9dd9817" name="Reset Global Data" type="SubSheet">
    <display x="495" y="390" w="90" h="60" />
    <onsuccess>86108f0f-bed5-4ba5-96b9-be3e3b9adcd3</onsuccess>
    <processid>146132fd-3da0-450f-9ab8-9e0828e4d6c2</processid>
  </stage>
  <stage stageid="86108f0f-bed5-4ba5-96b9-be3e3b9adcd3" name="Stop?" type="Decision">
    <display x="495" y="300" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
    <decision expression="IsStopRequested() OR LocalTime() &gt; [Stop After Time]" />
    <ontrue>7c12eee8-6f98-4f73-9036-17a5aaccfb48</ontrue>
    <onfalse>8d180fbf-bd0e-4911-ba8e-f59aec5bb072</onfalse>
  </stage>
  <stage stageid="7c12eee8-6f98-4f73-9036-17a5aaccfb48" name="Close" type="SubSheet">
    <display x="495" y="210" w="90" h="60" />
    <onsuccess>d84bc8fe-2be2-46c0-8bf0-769ca2efd860</onsuccess>
    <processid>838ed262-8e29-4c96-80e3-81eeeb98babd</processid>
  </stage>
  <stage stageid="4e4e3cef-ec1f-447f-af2f-be1194621ea4" name="Anchor6" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="180" y="210" w="10" h="10" />
    <onsuccess>7c12eee8-6f98-4f73-9036-17a5aaccfb48</onsuccess>
  </stage>
  <stage stageid="321bb792-2701-4555-b291-117084d5459d" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="390" y="795" w="10" h="10" />
    <onsuccess>f1cf6533-ab24-484e-9418-1a0bac472959</onsuccess>
  </stage>
  <stage stageid="8d447be7-4f7c-46eb-8aa2-b00245ad6f10" name="Envioriment Variables" type="Block">
    <display x="-390" y="345" w="150" h="285" />
    <font family="Segoe UI" size="10" style="Bold" color="FFFF00" />
  </stage>
  <stage stageid="ae1b40d9-7991-4100-850e-b6b7ba9dc0fa" name="05121_ExtracaoPath" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="375" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="082e4dd0-36f5-46a7-bf93-3c83cea3b104" name="05121_ExtracaoPathDownload" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="435" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="d87c2002-a65f-4db1-95bd-24dd265f65bb" name="Set Variables" type="MultipleCalculation">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="-165" w="90" h="60" />
    <onsuccess>0274b8d3-a3e3-46cb-bfea-39d69b8c13a8</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <steps>
      <calculation expression="FormatDateTime(Now()- MakeTimeSpan(0, 3, 0, 0),&quot;yyyy-MM-dd HH:mm:ss&quot;)" stage="str_updateTime" />
      <calculation expression="FormatDateTime(Now()- MakeTimeSpan(0, 3, 0, 0),&quot;yyyy-MM-dd 00:00:00&quot;)" stage="str_endTime" />
      <calculation expression="[Item Data.ID_COLABORADOR]" stage="nome_pasta" />
    </steps>
  </stage>
  <stage stageid="0b983c41-c2da-43ac-bd1a-f0a965c3b74e" name="\ Ao fim ?" type="Decision">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-30" y="75" w="90" h="30" />
    <decision expression="EndsWith([05121_ExtracaoPath], &quot;\&quot;)" />
    <ontrue>0771ef19-91b0-4028-87c4-bb97693b1f27</ontrue>
    <onfalse>7dd94cc1-5ba1-4e3e-9208-e65552bbb758</onfalse>
  </stage>
  <stage stageid="1df999cc-7bfc-47da-aaee-d2955b5c37cd" name="Create Directory" type="Action">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="195" />
    <inputs>
      <input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[str_pathUsuarioAtual]" />
      <input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="False" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_success" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>e14f013f-9ffb-435b-b71a-4ea93721f21e</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="7dd94cc1-5ba1-4e3e-9208-e65552bbb758" name="Anchor7" type="Anchor">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="75" w="10" h="10" />
    <onsuccess>c8a5472c-cf24-494c-b5b5-4157232a3f4e</onsuccess>
  </stage>
  <stage stageid="29508c84-d954-43f0-a96f-a870a28fb89a" name="Anchor7" type="Anchor">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="240" w="10" h="10" />
    <onsuccess>b1386159-4bc6-4256-a280-8bf3000f547f</onsuccess>
  </stage>
  <stage stageid="e14f013f-9ffb-435b-b71a-4ea93721f21e" name="Anchor7" type="Anchor">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="240" w="10" h="10" />
    <onsuccess>29508c84-d954-43f0-a96f-a870a28fb89a</onsuccess>
  </stage>
  <stage stageid="1a7628af-11e3-4bcb-b427-490fc1dbd7ff" name="fl_success" type="Data">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-195" y="-90" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3e30205-a01c-4c67-81b9-4bfb483042d0" name="str_message" type="Data">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-195" y="-60" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="719cb9b3-8206-4353-8bfd-9b1af2e6400f" name="Global Variables" type="Block">
    <display x="-210" y="225" w="150" h="330" />
    <font family="Segoe UI" size="10" style="Bold" color="808080" />
  </stage>
  <stage stageid="07531963-e9a0-4b79-9837-33991d799070" name="str_pathUsuarioAtual" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-135" y="255" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="b1386159-4bc6-4256-a280-8bf3000f547f" name="Directory Created ?" type="Decision">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-30" y="285" w="90" h="30" />
    <decision expression="[fl_success]" />
    <ontrue>a46277ce-bb39-495b-a7f7-1ff866df082c</ontrue>
    <onfalse>439f1461-a2d3-4d72-bf10-fb706f948b57</onfalse>
  </stage>
  <stage stageid="0771ef19-91b0-4028-87c4-bb97693b1f27" name="PathUser" type="Calculation">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="135" />
    <onsuccess>5c42fe22-0157-4e86-8729-303294f73e19</onsuccess>
    <calculation expression="[05121_ExtracaoPath] &amp; [nome_pasta]" stage="str_pathUsuarioAtual" />
  </stage>
  <stage stageid="c8a5472c-cf24-494c-b5b5-4157232a3f4e" name="PathUser" type="Calculation">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="135" />
    <onsuccess>1df999cc-7bfc-47da-aaee-d2955b5c37cd</onsuccess>
    <calculation expression="[05121_ExtracaoPath] &amp; &quot;\&quot; &amp; [nome_pasta]" stage="str_pathUsuarioAtual" />
  </stage>
  <stage stageid="439f1461-a2d3-4d72-bf10-fb706f948b57" name="System Exception" type="Exception">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="-135" y="285" />
    <exception localized="yes" type="System Exception" detail="&quot;5 - Não foi possível criar o diretório do item: &quot; &amp; [Item Data.ID_Usuario_Colaborador]" />
  </stage>
  <stage stageid="49d89e50-d8dd-4a96-9c4e-1b11badcf3d7" name="Set Variables" type="MultipleCalculation">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-195" w="90" h="60" />
    <onsuccess>07976e62-f7ed-4e4f-8f86-4d4586bb959e</onsuccess>
    <steps>
      <calculation expression="0" stage="Retry count" />
      <calculation expression="3" stage="Retry Limit" />
      <calculation expression="&quot;chrome&quot;" stage="str_processApplication" />
      <calculation expression="&quot;saplogon&quot;" stage="str_applicationSap" />
      <calculation expression="GetResourceName()" stage="str_resource" />
      <calculation expression="GetUserName()" stage="str_nmuser" />
      <calculation expression="&quot;05121_Geracao_Kit_Desligamento_RH&quot;" stage="str_process" />
      <calculation expression="&quot;192.168.0.1&quot;" stage="05121_IP_VM" />
      <calculation expression="&quot;05121_Geracao_Kit_Desligamento_RH&quot;" stage="Queue Name" />
    </steps>
  </stage>
  <stage stageid="d9c28a70-a805-4230-82cd-5cb7f7eef7ff" name="str_resource" type="Data">
    <display x="-135" y="345" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="30243271-1cf5-424b-ba55-37f59fc3c1fd" name="str_nmuser" type="Data">
    <display x="-135" y="390" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="daa6ab2d-5aba-46e4-b487-b63a302a5145" name="str_process" type="Data">
    <display x="-135" y="300" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="018740ef-a8b8-47fa-aae9-244ccbbfd4ae" name="str_processApplication" type="Data">
    <display x="-135" y="435" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="0ead246b-65f6-4f55-b51b-7ba4df6856d2" name="05121_IP_VM" type="Data">
    <display x="-135" y="525" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="cbcbdade-6583-4120-bfd6-826b5bfc3f38" name="05121_URL_Webhook_Informativo" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="480" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="bfdc665d-69ae-4029-b767-78ac0104ede2" name="05121_URL_Webhook_Avisos" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="525" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="09c1b0e2-b496-4158-9e59-c9be7002936b" name="Teams_Body Webhook Avisos" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="600" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">{
"@context": "https://schema.org/extensions",
"@type": "MessageCard",
"themeColor": "AA0000",
"title": "Processo Kit de Desligamento (Extrator)",
"text": "VALUE1",
"sections": [
{
"facts": [
{
"name": "Status:",
"value": "VALUE2"
},
{
"name": "Virtual Machine:",
"value": "VALUE3"
},
{
"name": "User:",
"value": "VALUE4"
},
{
"name": "ID do Processamento:",
"value": "VALUE5"
},
{
"name": "Detalhes do Erro:",
"value": "VALUE6"
}
],
"text": ""
}
],
}</initialvalue>
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="b04e8b66-8de0-4c81-9f85-5846f468cf94" name="Teams_Body Webhook Informativo" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="570" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">{
"@context": "https://schema.org/extensions",
"@type": "MessageCard",
"themeColor": "00AA00",
"title": "Processo Kit de Desligamento( Extrator)",
"text": "VALUE1",
"sections": [
{
"facts": [
{
"name": "Status:",
"value": "VALUE2"
},
{
"name": "Virtual Machine:",
"value": "VALUE3"
},
{
"name": "User:",
"value": "VALUE4"
},
{
"name": "Itens para Processamento:",
"value": "VALUE5"
}
],
"text": ""
}
],
}</initialvalue>
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="947013a7-e767-4877-8763-486c68b5484b" name="Credencial - Postgre" type="Data">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit />
    <display x="-225" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="31a18539-039d-4b75-acbb-c829dcc9e9f3" name="Credenciais Postgre " type="Block">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-45" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF00" />
  </stage>
  <stage stageid="e6f49407-1052-47f7-9bd6-5ebd1b7b7b9c" name="Set Variables" type="MultipleCalculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-240" w="90" h="60" />
    <onsuccess>68880ab4-fd7d-463e-9116-e5e59a28091d</onsuccess>
    <steps>
      <calculation expression="&quot;pgsh-pipeline.dc.nova&quot;" stage="Server" />
      <calculation expression="&quot;5432&quot;" stage="Port" />
      <calculation expression="&quot;db_sit_pipeline&quot;" stage="Database" />
      <calculation expression="&quot;Driver={PostgreSQL UNICODE};Server=&quot;&amp;[Server]&amp;&quot;;Port=&quot;&amp;[Port]&amp;&quot;;Database=&quot;&amp;[Database]&amp;&quot;;Uid=&quot;&amp;[Username]&amp;&quot;;Pwd=&quot;&amp;[Password]&amp;&quot;;sslmode=require;&quot;" stage="PROVIDER" />
      <calculation expression="FormatUTCDateTime(Now()- MakeTimeSpan(0, 3, 0, 0), &quot;yyyy-MM-dd HH:mm:ss&quot;)" stage="str_updateTime" />
    </steps>
  </stage>
  <stage stageid="e3f6bd44-7c73-4d3d-a3ea-3118c018290f" name="Credentials::Get" type="Action">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="180" y="-315" w="90" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credencial - Postgre]" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>e6f49407-1052-47f7-9bd6-5ebd1b7b7b9c</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="d666147a-2f86-4a34-9466-76ebd2416044" name="Credential Name" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-375" />
    <onsuccess>e3f6bd44-7c73-4d3d-a3ea-3118c018290f</onsuccess>
    <calculation expression="&quot;05121_Postgres_KitDesligamento&quot;" stage="Credencial - Postgre" />
  </stage>
  <stage stageid="04c050da-01bb-4249-9932-55b58b1422ff" name="Note1" type="Note">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <narrative>Informar Que o padrão é Desconhecido.</narrative>
    <display x="-75" y="555" w="90" h="60" />
    <onsuccess>e2a72c72-d79b-4e46-9717-f20aa9586403</onsuccess>
  </stage>
  <stage stageid="5692173b-eeec-43cf-86cb-bda27cc43599" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="315" />
    <onsuccess>0e467595-9ca1-4771-99f0-ba930a05ab07</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN ('ORIENTACOES',&#xA;                    'DISPENSA_JUSTA_CAUSA',&#xA;                    'RETIRADA_CARNE',&#xA;                    'TERMO_DEV_NOTEBOOK', &#xA;                    'TERMO_DEVOLUCAO_DISP_MOVEL', &#xA;                    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="0e467595-9ca1-4771-99f0-ba930a05ab07" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="315" w="10" h="10" />
    <onsuccess>367297c8-7c51-4222-9a96-ecb4c4c0c022</onsuccess>
  </stage>
  <stage stageid="e6e7a145-e395-4f6e-baba-6bd4492f99e7" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="375" />
    <onsuccess>367297c8-7c51-4222-9a96-ecb4c4c0c022</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN ('ORIENTACOES',                                                                                        'PEDIDO_DEMISSAO_SEM_CUMPRIMENTO_DESCONTO_AVISO_PREVIO',&#xA;                    'RETIRADA_CARNE',&#xA;                    'TERMO_DEV_NOTEBOOK', &#xA;                    'TERMO_DEVOLUCAO_DISP_MOVEL', &#xA;                    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="367297c8-7c51-4222-9a96-ecb4c4c0c022" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="375" w="10" h="10" />
    <onsuccess>074b6124-923a-4d8a-8bd7-83cad4ce8dee</onsuccess>
  </stage>
  <stage stageid="a9df4f18-575e-4563-9962-990ab44ae9e4" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="435" />
    <onsuccess>074b6124-923a-4d8a-8bd7-83cad4ce8dee</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS Status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN (&#xA;    'ORIENTACOES',&#xA;    'AVISO_TERM_CONTRATO_ANTEC_EMPREGADOR',&#xA;    'RETIRADA_CARNE',&#xA;    'TERMO_DEV_NOTEBOOK',&#xA;    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="074b6124-923a-4d8a-8bd7-83cad4ce8dee" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="435" w="10" h="10" />
    <onsuccess>db810a62-09a6-4319-988e-4594c3a65a65</onsuccess>
  </stage>
  <stage stageid="077b49f7-02d5-47c8-8cf1-985b3b0c1e01" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="195" />
    <onsuccess>0f5ccc08-dbcc-4b88-b7d7-9eb2d0466aa6</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS Status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN (&#xA;    'ORIENTACOES',&#xA;    'DISPENSA_SEM_JUSTA_CAUSA',&#xA;    'RETIRADA_CARNE',&#xA;    'TERMO_DEV_NOTEBOOK',&#xA;    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="0f5ccc08-dbcc-4b88-b7d7-9eb2d0466aa6" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="195" w="10" h="10" />
    <onsuccess>c79dc02a-e24e-4dab-a94f-e1ea046b906a</onsuccess>
  </stage>
  <stage stageid="f8833dc2-b86b-4d58-9942-2d72dc5e3a9f" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-105" />
    <onsuccess>5f0975f5-b360-4819-a6ff-f5e7cc0b8308</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN ('ORIENTACOES',&#xA;                    'PEDIDO_DEMISSAO_SEM_CUMPRIMENTO_DESCONTO_AVISO_PREVIO',&#xA;                    'RETIRADA_CARNE', &#xA;                    'TERMO_DEV_NOTEBOOK',&#xA;                    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;                    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="7836ad25-e620-4dd2-b413-1f6ce6f72396" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="-45" w="10" h="10" />
    <onsuccess>70aa10d8-e786-4cff-a649-5658a19fb9e8</onsuccess>
  </stage>
  <stage stageid="5f0975f5-b360-4819-a6ff-f5e7cc0b8308" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="-105" w="10" h="10" />
    <onsuccess>7836ad25-e620-4dd2-b413-1f6ce6f72396</onsuccess>
  </stage>
  <stage stageid="9e5bf22e-4621-446a-91b4-b2dcdb9f8adc" name="SELECT" type="Calculation">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-45" />
    <onsuccess>7836ad25-e620-4dd2-b413-1f6ce6f72396</onsuccess>
    <calculation expression="&quot;SELECT id, documento, 'NOK' AS status &#xA;FROM tb_rh_kit_deslicamento_documento &#xA;WHERE documento IN ('ORIENTACOES',&#xA;                    'PEDIDO_DEMISSAO_SEM_CUMPRIMENTO_DESCONTO_AVISO_PREVIO',&#xA;                    'RETIRADA_CARNE', &#xA;                    'TERMO_DEV_NOTEBOOK',&#xA;                    'TERMO_DEVOLUCAO_DISP_MOVEL',&#xA;                    'ENCAMINHAMENTO_EXAME')&quot;&#xA;" stage="QUERY" />
  </stage>
  <stage stageid="70a27d47-d5cd-4e09-832a-ab03a7b2c829" name="2.5 - SAP_DAP" type="SubSheetInfo">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="-210" y="-165" w="150" h="90" />
  </stage>
  <stage stageid="18752fce-ce86-4ab3-b674-95b7b87015b2" name="Start" type="Start">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="15" y="-195" />
    <onsuccess>ec31e7d7-762d-4f7f-87eb-362d8727c934</onsuccess>
  </stage>
  <stage stageid="563d67a7-e4ee-4ab4-8df4-a046680f6f7e" name="End" type="End">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="15" y="105" />
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="9536ec9f-a32e-4565-b5fa-11a704ede298" name="Count = 0" type="Calculation">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" />
    <onsuccess>8782c636-d3a7-4329-9f16-07cbd10d7413</onsuccess>
    <calculation expression="0" stage="Retry count" />
  </stage>
  <stage stageid="999fb453-32e8-4ff6-8ac1-79b64f5a4e91" name="str_applicationSap" type="Data">
    <display x="-135" y="480" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="6889501a-bfce-4ed8-babb-63f0ea5e166c" name="APP2 - SAP" type="Block">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="105" w="225" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5044f71f-163d-4328-8607-e65a45557568" name="Resume" type="Resume">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit />
    <display x="120" y="75" />
    <onsuccess>8782c636-d3a7-4329-9f16-07cbd10d7413</onsuccess>
  </stage>
  <stage stageid="64bd2bf5-b98f-4f86-a4ac-9aa5bc13737c" name="Recover" type="Recover">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit />
    <display x="120" y="150" />
    <onsuccess>752bee27-e6fb-4ea7-9c36-73c1e58370bd</onsuccess>
  </stage>
  <stage stageid="752bee27-e6fb-4ea7-9c36-73c1e58370bd" name="Retry" type="Decision">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="225" y="150" w="90" h="30" />
    <decision expression="[Retry count]&lt;[Retry Limit]" />
    <ontrue>74c38cb6-575c-4a6b-a126-ed6cede93116</ontrue>
    <onfalse>67167d65-b92a-43e0-a97b-790af68bc333</onfalse>
  </stage>
  <stage stageid="74c38cb6-575c-4a6b-a126-ed6cede93116" name="Count ++" type="Calculation">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="225" y="75" />
    <onsuccess>5044f71f-163d-4328-8607-e65a45557568</onsuccess>
    <calculation expression="[Retry count]+1" stage="Retry count" />
  </stage>
  <stage stageid="67167d65-b92a-43e0-a97b-790af68bc333" name="Throw" type="Exception">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <display x="330" y="150" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="68aab87e-65cf-4aeb-a9f7-a495c434633c" name="DAP ?" type="Decision">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="15" y="15" w="90" h="30" />
    <decision expression="Lower([Lista Documentos.documento]) = &quot;dap&quot;" />
    <ontrue>2cf7ddab-7d3b-4a9a-96db-48c4ac076b01</ontrue>
    <onfalse>0e986804-644f-473b-97b6-b7eda14a145a</onfalse>
  </stage>
  <stage stageid="ec31e7d7-762d-4f7f-87eb-362d8727c934" name="2.2 - Search Termo DAP" type="Action">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" w="90" h="30" />
    <inputs>
      <input type="text" name="Numero Pessoal" friendlyname="Numero Pessoal" expr="[Item Data.ID_Usuario_Colaborador]" />
      <input type="text" name="Path" friendlyname="Path" expr="[str_pathUsuarioAtual]" />
    </inputs>
    <onsuccess>3d9b61ef-c5f6-4801-a560-a524268be258</onsuccess>
    <resource object="SAP" action="2.2 - Search Termo DAP" />
  </stage>
  <stage stageid="03714676-175b-4ea9-a80b-f07bfa39c282" name="Update PostgreSql" type="SubSheetInfo">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-240" w="150" h="90" />
  </stage>
  <stage stageid="a54233e0-4497-47d3-9baa-2da8b390ee0f" name="Server" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">pgsh-pipeline.dc.nova</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="22619f23-99a2-4b82-bd03-30ee3ba1e695" name="Port" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="180" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">5432</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="392ecc55-7997-4c74-994d-ebf6737b54cf" name="Database" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="210" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">db_sit_pipeline</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c9b63994-560f-4809-93c3-48557c71a332" name="PROVIDER" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="435" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0f49bbba-e7f5-4470-8dcb-a61e24e4e1af" name="Provider Output" type="Block">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-345" y="405" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0e72ab25-6a40-4723-934b-3553a0b866db" name="STATUS_CONEX" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="495" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6dfae427-7740-4e3f-8179-0a3fc25d23ce" name="MESSAGE_CONEX" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="465" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="656a5915-9fa2-4da7-a695-1c4bf97711a3" name="Query" type="Block">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-345" y="540" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="93e85c5c-086c-4377-abef-9e3de9b29d43" name="STATUS_QUERY" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="660" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="65927d49-c3ac-482c-9a7e-a730e6c4df27" name="MESSAGE_QUERY" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="630" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="223a7ae7-897b-4795-94db-366844636d72" name="Input Query" type="Block">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-345" y="-180" w="150" h="285" />
    <font family="Segoe UI" size="10" style="Regular" color="800080" />
  </stage>
  <stage stageid="04037396-e8af-4717-9510-13b04913a989" name="Update Query" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="570" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="aff02244-e378-4d4a-889f-9339c40de97c" name="QUERY" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="600" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d8f41ea1-f43e-4580-99f8-6d88b51d9f29" name="str_RefNumber" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="591da117-f785-4d21-acd4-2364cef89950" name="str_ExecTime" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="abc0422d-6222-436f-a493-65031837cedc" name="str_Note" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="0" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="35d83d22-61c5-45ce-956f-b43e07ca5dd5" name="str_Adquirente" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-60" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a71e9800-3acb-487d-a8a2-73d6acff3819" name="str_StatusJob" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5a047fcd-3d1c-4cf0-b930-7996f77d819d" name="str_OrderNumber" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="-120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="805d415a-46b4-442f-97c7-a567210e8f2a" name="nu_Status" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="30" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eca1f98e-a17a-4965-a682-54f3fd4f7bad" name="str_updateTime" type="Data">
    <display x="-315" y="255" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="3d9b61ef-c5f6-4801-a560-a524268be258" name="1.4 - Ler MSG" type="Action">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <outputs>
      <output type="text" name="Mensagem Bar" friendlyname="Mensagem Bar" stage="str_mensagem" />
    </outputs>
    <onsuccess>3d7cc86f-5327-4b3e-a3cb-fb036807b609</onsuccess>
    <resource object="SAP" action="1.4 - Ler Mensagem" />
  </stage>
  <stage stageid="6c11ec64-e1d4-4b10-ae25-7f9a60158cc3" name="str_mensagem" type="Data">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="-210" y="-75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3d7cc86f-5327-4b3e-a3cb-fb036807b609" name="Não Encontrada ?" type="Decision">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <decision expression="Lower([str_mensagem]) = &quot;informação não encontrada!&quot;" />
    <ontrue>fc59440a-2838-4dc5-959c-0f6e60ac2ba2</ontrue>
    <onfalse>1ec84e19-eb43-4f9f-a151-2b26835ad34b</onfalse>
  </stage>
  <stage stageid="0e94b500-d555-4d75-8873-14e0d951ff28" name="Local Variables" type="Block">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-105" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
  </stage>
  <stage stageid="383e96ee-ecb9-4836-8b9f-61a609aff427" name="Termo de Ciencia DAP" type="Block">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-165" w="210" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4f156fb3-5022-4528-aec1-ba72c5d1a92f" name="Anchor10" type="Anchor">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="105" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
    <onsuccess>563d67a7-e4ee-4ab4-8df4-a046680f6f7e</onsuccess>
  </stage>
  <stage stageid="e39aed09-b670-4133-bfb1-3462e74a3047" name="2.2 - Insert User" type="SubSheetInfo">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="-180" y="-240" w="150" h="90" />
  </stage>
  <stage stageid="e39c86da-4d1b-4242-99f2-c494d9cbe393" name="Start" type="Start">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="15" y="-270" />
    <onsuccess>7481ccca-0570-4c08-a9ec-1360c091909e</onsuccess>
  </stage>
  <stage stageid="10e3af7f-5c28-417c-9eae-a9e9680daaaf" name="Provider Input" type="Block">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-345" y="120" w="150" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="993300" />
  </stage>
  <stage stageid="9f48a77b-5cb2-475a-8c63-68b1b09e863b" name="Password" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="360" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5949b90a-29d7-4b9d-8bb1-ec85bbf03ddc" name="Username" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="330" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="309301c9-2bec-4c32-9194-56be0ef317f4" name="Credencial - Postgre" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit />
    <display x="-270" y="285" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7d263f38-df6b-4f63-837e-9e5522b21381" name="Credenciais Postgre " type="Block">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-345" y="255" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF00" />
  </stage>
  <stage stageid="a63a9224-1079-40fd-a454-53a77ce7fcf4" name="2.2 - Insert User" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="90" h="60" />
    <onsuccess>a038db39-4900-44ad-a8d0-405b25ec00b6</onsuccess>
    <processid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</processid>
  </stage>
  <stage stageid="71bfb120-7e71-45a6-bd95-2d80155d8bac" name="Local Variables" type="Block">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="-255" y="-180" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
  </stage>
  <stage stageid="f354ac33-742a-4527-8d61-fffdfc8934bd" name="3 - Move To Exception Folder" type="SubSheetInfo">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="-195" w="150" h="90" />
  </stage>
  <stage stageid="e419f019-2ec1-4dc3-a3d4-b01a0fd1a672" name="Start" type="Start">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="15" y="-225" />
    <onsuccess>af3e7dea-bd0f-407e-9e52-552bfa3cdf6a</onsuccess>
  </stage>
  <stage stageid="12bc22b4-3ec4-48b0-8aaa-44de05be2869" name="End" type="End">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="15" y="585" />
  </stage>
  <stage stageid="fadf8a05-ead1-4c82-8bdc-a7cb2a83b006" name="col_files" type="Collection">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="-90" w="120" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1cd572ad-df09-4ea1-bb77-92daff953751" name="str_filePattern" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="0" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cbe1802c-bc4b-4fbb-948b-2f80ffff25e2" name="Local Variables" type="Block">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-135" w="150" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b4d46bfa-00c0-4b91-ab19-86a3d61ef418" name="Validation and Treatment" type="Block">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="135" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="3d589230-cf86-4418-85d9-5e7e2faf066b" name="Move File" type="Action">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="315" w="90" h="30" />
    <inputs>
      <input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[col_files.Path]" />
      <input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[str_pathUsuarioError]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_moved" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_msg" />
    </outputs>
    <onsuccess>21b8dfa6-e1c8-41e8-8155-1c7d2e9f34c3</onsuccess>
    <resource object="Utility - File Management" action="Move File" />
  </stage>
  <stage stageid="773c4cf5-704a-4d44-b78e-2f89d85451bf" name="fl_moved" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="255" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="28ea640c-d886-48c3-aed8-c38c6ab454b2" name="Filtered" type="LoopStart">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="255" />
    <onsuccess>3d589230-cf86-4418-85d9-5e7e2faf066b</onsuccess>
    <groupid>6b2fdecd-2fa5-4e22-99e9-49f355a6f031</groupid>
    <looptype>ForEach</looptype>
    <loopdata>col_files</loopdata>
  </stage>
  <stage stageid="96a85bb0-41ab-4304-bd95-8b9c72af91d7" name="Filtered" type="LoopEnd">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="435" />
    <onsuccess>1d883552-17b1-4240-91fc-1985d2d27c43</onsuccess>
    <groupid>6b2fdecd-2fa5-4e22-99e9-49f355a6f031</groupid>
  </stage>
  <stage stageid="2014e1e0-f809-4e91-b1fa-69f3f42caf2f" name="fl_fileDownloaded" type="Data">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="-225" y="-90" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7481ccca-0570-4c08-a9ec-1360c091909e" name="Set Variables" type="MultipleCalculation">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-195" w="90" h="60" />
    <onsuccess>e4dfd710-1c18-4875-b3c6-2d3f4969cf93</onsuccess>
    <steps>
      <calculation expression="0" stage="Retry count" />
      <calculation expression="3" stage="Retry Limit" />
    </steps>
  </stage>
  <stage stageid="2facd19b-8e05-4b5f-8e18-f4e3107b91fe" name="Retry Limit" type="Data">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="-180" y="-45" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="86df0dbb-e548-4252-b9c5-77703458fca6" name="Retry count" type="Data">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="-180" y="-75" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a47473b-15e5-4692-8c0c-93a887e70221" name="2.0 - CHKB Users Inativos" type="Action">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <onsuccess>68287257-b6f1-4ec7-b088-07ae857df13c</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="2.0 - Gerar Documento - CHKB Users Inativos" />
  </stage>
  <stage stageid="68287257-b6f1-4ec7-b088-07ae857df13c" name="2.1 - Inserir Usuario" type="Action">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" w="90" h="30" />
    <inputs>
      <input type="text" name="ID_Colaborador" friendlyname="ID_Colaborador" expr="[Item Data.ID_Usuario_Colaborador]" />
    </inputs>
    <outputs>
      <output type="text" name="Usuario" friendlyname="Usuario" stage="str_usuario" />
    </outputs>
    <onsuccess>4535a28b-3e7e-4595-835c-568c5c1c6573</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="2.1 - Inserir Usuario" />
  </stage>
  <stage stageid="4535a28b-3e7e-4595-835c-568c5c1c6573" name="Exist ?" type="Decision">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="15" y="105" w="90" h="30" />
    <decision expression="InStr(Lower([str_usuario]),[Item Data.nome]) &lt;&gt; 0" />
    <ontrue>494bd0e1-ab0c-47e7-8c43-f55a15b5f25d</ontrue>
    <onfalse>c13b664d-25e5-4597-b3ec-203a3cec3793</onfalse>
  </stage>
  <stage stageid="c13b664d-25e5-4597-b3ec-203a3cec3793" name="Limit ?" type="Decision">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="135" y="105" w="90" h="30" />
    <decision expression="[Retry count] = [Retry Limit]" />
    <ontrue>78d36501-25ff-4ee2-97f3-4b443e88e5b2</ontrue>
    <onfalse>ea093b9e-3a00-45b3-a0f7-ea26d1207450</onfalse>
  </stage>
  <stage stageid="ea093b9e-3a00-45b3-a0f7-ea26d1207450" name="Count ++" type="Calculation">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="45" />
    <onsuccess>68287257-b6f1-4ec7-b088-07ae857df13c</onsuccess>
    <calculation expression="[Retry count] + 1" stage="Retry count" />
  </stage>
  <stage stageid="d8d54005-ba29-4583-9942-6d0aedef3123" name="str_usuario" type="Data">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="-180" y="-150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d243f215-191d-4bba-bf8a-c5cd44b52518" name="Treatment And Exceptions" type="Block">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-105" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="494bd0e1-ab0c-47e7-8c43-f55a15b5f25d" name="End1" type="End">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="180" />
  </stage>
  <stage stageid="5b93e0d3-e1ba-40a0-9373-522413680636" name="HomolSind = 999 ?" type="Decision">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="300" y="675" w="90" h="30" />
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <decision expression="[Item Data.detalhes do emprego meses p/ homologacao no sindicato] = &quot;999&quot;" />
    <ontrue>ed1a8ba9-1b6d-4d06-8cb1-94d9088c451a</ontrue>
    <onfalse>fe7fef8b-feee-4822-984a-4a4e29508522</onfalse>
  </stage>
  <stage stageid="fe7fef8b-feee-4822-984a-4a4e29508522" name="Anchor3" type="Anchor">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="390" y="675" w="10" h="10" />
    <onsuccess>321bb792-2701-4555-b291-117084d5459d</onsuccess>
  </stage>
  <stage stageid="ed1a8ba9-1b6d-4d06-8cb1-94d9088c451a" name="Append Row" type="Action">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="300" y="735" w="90" h="30" />
    <inputs>
      <input type="collection" name="Main Collection" friendlyname="Main Collection" narrative="The collection to append to." expr="[Lista Documentos]" />
      <input type="collection" name="Collection to Append" friendlyname="Collection to Append" narrative="The collection to append." expr="[ComunicadoHomol]" />
    </inputs>
    <outputs>
      <output type="collection" name="Combined Collection" friendlyname="Combined Collection" narrative="The combined collection." stage="Lista Documentos" />
    </outputs>
    <onsuccess>f1cf6533-ab24-484e-9418-1a0bac472959</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Append Rows to Collection" />
  </stage>
  <stage stageid="23954fb5-ec3b-493f-b114-163b19cee978" name="ComunicadoHomol" type="Collection">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="-225" y="420" w="120" h="60" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <field name="id" type="number" />
      <field name="documento" type="text" />
      <field name="status" type="text" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="id" type="number" value="20" />
        <field name="documento" type="text" value="COMUNICADO_AG_HOMOLOG" />
        <field name="status" type="text" value="NOK" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="0c94578f-f973-4551-ad35-3fc8aec80b9a" name="Item Data" type="Collection">
    <display x="-135" y="690" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>collection</datatype>
    <noalwaysinit />
  </stage>
  <stage stageid="9598aa80-c7cf-4b4d-9a1d-1c0ad7654392" name="2.3 - Insert Model" type="SubSheetInfo">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-195" y="-165" w="150" h="90" />
  </stage>
  <stage stageid="51cfb429-3755-4073-8b7e-2e0746b16128" name="Start" type="Start">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="15" y="-195" />
    <onsuccess>326d2384-0d07-4110-af1b-1abf06a75d55</onsuccess>
  </stage>
  <stage stageid="81f5c528-4136-4db6-b21f-207864833ff9" name="End" type="End">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="a08280b0-7ee0-49df-8f37-0f452c38118f" name="Inserir Modelo" type="Action">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Modelo" friendlyname="Modelo" expr="[Lista Documentos.documento]" />
    </inputs>
    <outputs>
      <output type="text" name="Modelo" friendlyname="Modelo" stage="str_model" />
    </outputs>
    <onsuccess>36d91606-3f36-4427-a95a-2e675e595d2d</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="2.2 - Inserir Modelo" />
  </stage>
  <stage stageid="0e986804-644f-473b-97b6-b7eda14a145a" name="2.3 - Insert Model" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="90" w="90" h="60" />
    <onsuccess>9b8ee843-ed20-4ab5-af3e-e5716c24249a</onsuccess>
    <processid>562f28c5-23b6-4e34-91db-68c96585f0fd</processid>
  </stage>
  <stage stageid="223ca552-96fa-419c-999f-838fc9029656" name="str_model" type="Data">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-195" y="-75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3dabec7e-95dc-4808-ac88-df5c755c4ed0" name="Local Variables" type="Block">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-270" y="-105" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="99CCFF" />
  </stage>
  <stage stageid="10aec9a4-4b46-4877-8180-2155a11d760b" name="Reader Warning" type="Action">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" w="90" h="30" />
    <onsuccess>81f5c528-4136-4db6-b21f-207864833ff9</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="2.2.1 - Ler Msg de Aviso" />
  </stage>
  <stage stageid="64888bdc-6fc3-4f7b-9cfc-0a074f914caf" name="str_msg" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="84f07374-f0b2-4d15-ac1e-949a35dafb74" name="Work Step 1" type="Block">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-150" w="225" h="300" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4857a54e-36eb-4829-971c-854f10697fd5" name="Resume" type="Resume">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit />
    <display x="135" y="-120" />
    <onsuccess>e4dfd710-1c18-4875-b3c6-2d3f4969cf93</onsuccess>
  </stage>
  <stage stageid="ca65500e-83ea-41d9-93c7-4d3800158668" name="Recover" type="Recover">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit />
    <display x="135" y="0" />
    <onsuccess>c94b2d4f-eeb5-4a4a-89ba-838c23a0dbed</onsuccess>
  </stage>
  <stage stageid="c94b2d4f-eeb5-4a4a-89ba-838c23a0dbed" name="Retry" type="Decision">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="240" y="0" w="90" h="30" />
    <decision expression="[Retry count]=[Retry Limit]" />
    <ontrue>63b55408-b32e-476a-ba73-d6527770d832</ontrue>
    <onfalse>28c84650-bfce-472b-89c0-7e793ada6ae0</onfalse>
  </stage>
  <stage stageid="a8d1b08a-8eb0-47d7-a6a2-eb4a3d462161" name="Count ++" type="Calculation">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="240" y="-120" />
    <onsuccess>4857a54e-36eb-4829-971c-854f10697fd5</onsuccess>
    <calculation expression="[Retry count]+1" stage="Retry count" />
  </stage>
  <stage stageid="28c84650-bfce-472b-89c0-7e793ada6ae0" name="Throw" type="Exception">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="345" y="0" />
    <exception localized="yes" type="Business Exception" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="e4dfd710-1c18-4875-b3c6-2d3f4969cf93" name="Anchor2" type="Anchor">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="10" h="10" />
    <onsuccess>6a47473b-15e5-4692-8c0c-93a887e70221</onsuccess>
  </stage>
  <stage stageid="7224f05c-1578-4b93-adf2-e0a65bbe6f21" name="Limit ?" type="Decision">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="135" y="75" w="90" h="30" />
    <decision expression="[Retry count] = [Retry Limit]" />
    <ontrue>eb7f5f9b-da6f-41fc-9972-326b934770cb</ontrue>
    <onfalse>c0219213-2472-43b5-a444-116e41d89dfb</onfalse>
  </stage>
  <stage stageid="eb7f5f9b-da6f-41fc-9972-326b934770cb" name="System Exception" type="Exception">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="240" y="75" />
    <exception localized="yes" type="System Exception" detail="&quot; 5 - Não foi possivel inserir o modelo de documento.&quot;" />
  </stage>
  <stage stageid="c0219213-2472-43b5-a444-116e41d89dfb" name="Count ++" type="Calculation">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="-45" />
    <onsuccess>a08280b0-7ee0-49df-8f37-0f452c38118f</onsuccess>
    <calculation expression="[Retry count] + 1" stage="Retry count" />
  </stage>
  <stage stageid="36d91606-3f36-4427-a95a-2e675e595d2d" name="Status List Model" type="Action">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="90" h="30" />
    <outputs>
      <output type="text" name="Status List Model" friendlyname="Status List Model" stage="str_statusListModel" />
    </outputs>
    <onsuccess>8ccbe10a-128f-4e27-9a2d-636fad9f141c</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="2.2.2 - Status Chkbox Modelo" />
  </stage>
  <stage stageid="9e143d2c-e366-4f61-80f6-2ec46e93a233" name="str_statusListModel" type="Data">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-195" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8ccbe10a-128f-4e27-9a2d-636fad9f141c" name="ListExpanded ?" type="Decision">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="15" y="75" w="90" h="30" />
    <decision expression="[str_statusListModel] = &quot;True&quot;" />
    <ontrue>7224f05c-1578-4b93-adf2-e0a65bbe6f21</ontrue>
    <onfalse>10aec9a4-4b46-4877-8180-2155a11d760b</onfalse>
  </stage>
  <stage stageid="62321c7c-e998-4b74-9e92-bbbaef8098f0" name="Retry Limit" type="Data">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-195" y="75" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="04a58d5b-ecec-4b27-a338-6b5879f516bb" name="Retry count" type="Data">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9a77c3d9-4eb1-4d7c-8cee-005667bb9e41" name="Treatment And Exceptions" type="Block">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="15" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="326d2384-0d07-4110-af1b-1abf06a75d55" name="Set Variables" type="MultipleCalculation">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" w="90" h="60" />
    <onsuccess>a08280b0-7ee0-49df-8f37-0f452c38118f</onsuccess>
    <steps>
      <calculation expression="0" stage="Retry count" />
      <calculation expression="3" stage="Retry Limit" />
    </steps>
  </stage>
  <stage stageid="be8f865d-880a-4aaf-b38d-0c8239dfc678" name="Start" type="Start">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="-270" />
    <inputs>
      <input type="text" name="StatusJob" stage="str_StatusJob" />
      <input type="text" name="ExecutionTime" stage="str_ExecTime" />
      <input type="text" name="Note" stage="str_Note" />
      <input type="number" name="Status" stage="nu_Status" />
    </inputs>
    <onsuccess>35fb6e3b-9f4f-4fda-b83d-bc97434c4765</onsuccess>
  </stage>
  <stage stageid="74b721b6-bd4a-4a01-a649-c12507f11937" name="End" type="End">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="180" />
  </stage>
  <stage stageid="950873c3-0640-494b-b489-662b3b3d3fea" name="ExecuteNonQuery" type="Action">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="60" w="90" h="30" />
    <inputs>
      <input type="text" name="Query String" friendlyname="Query String" narrative="The query string to execute against the data source." expr="[QUERY]" />
    </inputs>
    <outputs>
      <output type="flag" name="Status" friendlyname="Status" narrative="A flag indicate success (True) or failure (False) of the action." stage="STATUS_QUERY" />
      <output type="text" name="Message" friendlyname="Message" narrative="If an error occurs, any message will be found in this data item." stage="MESSAGE_QUERY" />
    </outputs>
    <onsuccess>744c994b-2823-43cb-9de3-9aaad7434b6c</onsuccess>
    <resource object="Data - ODBC" action="ExecuteNonQuery" />
  </stage>
  <stage stageid="744c994b-2823-43cb-9de3-9aaad7434b6c" name="Data - ODBC::Close" type="Action">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="120" w="90" h="30" />
    <onsuccess>74b721b6-bd4a-4a01-a649-c12507f11937</onsuccess>
    <resource object="Data - ODBC" action="Close" />
  </stage>
  <stage stageid="5e3843c5-d638-4fce-88ca-e05b9e4e6a51" name="Data - ODBC::Open" type="Action">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Connection String" friendlyname="Connection String" narrative="The ODBC connection stirng for your specific data source." expr="[PROVIDER]" />
    </inputs>
    <outputs>
      <output type="flag" name="Status" friendlyname="Status" narrative="Flag indicating success or failure of the Open operation. True if the connection was successfully opened. Otherwise, False." stage="STATUS_CONEX" />
      <output type="text" name="Message" friendlyname="Message" narrative="If an error was encountered, this parameter will contain that message." stage="MESSAGE_CONEX" />
    </outputs>
    <onsuccess>950873c3-0640-494b-b489-662b3b3d3fea</onsuccess>
    <resource object="Data - ODBC" action="Open" />
  </stage>
  <stage stageid="c939b6f8-fdc7-4a6a-b53a-a0c857a9e95a" name="Create Update Query" type="MultipleCalculation">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="15" y="-75" w="90" h="60" />
    <onsuccess>5e3843c5-d638-4fce-88ca-e05b9e4e6a51</onsuccess>
    <steps>
      <calculation expression="&quot;public.tb_rh_kit_deslicamento_matricula&quot;" stage="str_tabelaPostgre" />
      <calculation expression="&quot;UPDATE nomeProcesso SET	process = '{process}',&#xA;    updatetime = '{updatetime}',&#xA;    endtime = '{endtime}',&#xA;    tempoexecucao = '{tempoexecucao}',&#xA;    statusjob = '{statusjob}',&#xA;    observacao = '{observacao}',&#xA;    status = '{status}'&#xA;WHERE idusuariocolaborador = '{id}';&quot;" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;nomeProcesso&quot;, [str_tabelaPostgre])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{process}&quot;, [str_process])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{endtime}&quot;, [str_endTime])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{updatetime}&quot;, [str_updateTime])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{tempoexecucao}&quot;, [str_ExecTime])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{statusjob}&quot;, [str_StatusJob])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{observacao}&quot;, [str_Note])" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{id}&quot;, [Item Data.ID_COLABORADOR])&#xA;" stage="Update Query" />
      <calculation expression="Replace([Update Query], &quot;{status}&quot;, [nu_Status])" stage="QUERY" />
      <calculation expression="&quot;pgsh-pipeline.dc.nova&quot;" stage="Server" />
      <calculation expression="&quot;5432&quot;" stage="Port" />
      <calculation expression="&quot;db_sit_pipeline&quot;" stage="Database" />
      <calculation expression="&quot;Driver={PostgreSQL UNICODE};Server=&quot;&amp;[Server]&amp;&quot;;Port=&quot;&amp;[Port]&amp;&quot;;Database=&quot;&amp;[Database]&amp;&quot;;Uid=&quot;&amp;[Username]&amp;&quot;;Pwd=&quot;&amp;[Password]&amp;&quot;;sslmode=require;&quot;" stage="PROVIDER" />
    </steps>
  </stage>
  <stage stageid="0c161c34-e0a3-479e-8035-cf593bcd6b5d" name="Update Status" type="Action">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <narrative>Updates the status field for the item. The status field can be used to flag what has been done in a process so far. If a process encounters an exception, this information can be used to skip to the parts of the process not yet done for the item next time it is worked. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.

This action will also reset the Attempts column to zero, because if the status updated the process should have successfully done something.</narrative>
    <display x="120" y="-75" />
    <inputs>
      <input type="text" name="Status" narrative="The new status - 255 characters maximum." expr="[Status]" />
      <input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
    </inputs>
    <onsuccess>a50a0665-b72e-4ce2-bff8-25ea15c4f927</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Update Status" />
  </stage>
  <stage stageid="806dfab5-07de-4ee1-b051-5219613f3b26" name="Mark Exception" type="Action">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="120" y="555" w="90" h="30" />
    <inputs>
      <input type="text" name="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
      <input type="text" name="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Type]&amp;&quot;: &quot;&amp;[Exception Detail]" />
      <input type="flag" name="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="" />
      <input type="flag" name="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="" />
    </outputs>
    <onsuccess>7c566ef1-6b12-400e-aa3c-1adf1b76807c</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="a50a0665-b72e-4ce2-bff8-25ea15c4f927" name="Business Exception?" type="Decision">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="0" w="90" h="60" />
    <decision expression="InStr(Lower([Exception Type]),&quot;business&quot;) &lt;&gt; 0" />
    <ontrue>f638e0c1-f5dc-4b97-b3ef-eeb420c6e586</ontrue>
    <onfalse>48002621-8244-4184-a058-7ab51e132504</onfalse>
  </stage>
  <stage stageid="0061575f-1790-433f-b685-6df1f1c4068e" name="Anchor8" type="Anchor">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="285" y="555" w="10" h="10" />
    <onsuccess>806dfab5-07de-4ee1-b051-5219613f3b26</onsuccess>
  </stage>
  <stage stageid="7953a079-1c15-4f69-9a03-f273df97bd7b" name="Count++" type="Calculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-30" y="315" />
    <onsuccess>71e32e5d-5ec6-4b2b-8012-cd08bcb30807</onsuccess>
    <calculation expression="[nu_ExceptionCount]+1" stage="nu_ExceptionCount" />
  </stage>
  <stage stageid="ec9224d7-a028-40cf-af9b-09597e165f6e" name="Last Exception" type="Calculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="480" w="90" h="60" />
    <onsuccess>806dfab5-07de-4ee1-b051-5219613f3b26</onsuccess>
    <calculation expression="[Exception Type]&amp;&quot; &quot;&amp;[Exception Detail]" stage="str_LastException" />
  </stage>
  <stage stageid="26aed340-e5ef-4475-8aba-b48c1b43f68f" name="Same Exception?" type="Decision">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="315" w="90" h="30" />
    <decision expression="InStr(Lower(([Exception Type]&amp;&quot; &quot;&amp;[Exception Detail])), Lower([str_LastException])) &lt;&gt; 0" />
    <ontrue>7953a079-1c15-4f69-9a03-f273df97bd7b</ontrue>
    <onfalse>bc1f3f72-34c5-43e2-850e-d4446d82dfa3</onfalse>
  </stage>
  <stage stageid="71e32e5d-5ec6-4b2b-8012-cd08bcb30807" name="Anchor9" type="Anchor">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-30" y="480" w="10" h="10" />
    <onsuccess>ec9224d7-a028-40cf-af9b-09597e165f6e</onsuccess>
  </stage>
  <stage stageid="7c566ef1-6b12-400e-aa3c-1adf1b76807c" name="Exception Limit?" type="Decision">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="630" w="90" h="60" />
    <decision expression="[nu_ExceptionCount] &gt; [nu_ExceptionLimit]" />
    <ontrue>a3c2eb8c-ebbc-4fa4-8255-905c9b743801</ontrue>
    <onfalse>090fc7b2-481f-46af-9ecd-76facd6916d7</onfalse>
  </stage>
  <stage stageid="a3c2eb8c-ebbc-4fa4-8255-905c9b743801" name="Terminate" type="Exception">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="225" y="630" />
    <exception localized="yes" type="Exception" detail="[Exception Type]&amp;&quot;: &quot;&amp;[Exception Detail]" />
  </stage>
  <stage stageid="7e5fc446-a081-4136-9320-64a2673ec570" name="Reset Count" type="Calculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="285" y="495" />
    <onsuccess>0061575f-1790-433f-b685-6df1f1c4068e</onsuccess>
    <calculation expression="0" stage="nu_ExceptionCount" />
  </stage>
  <stage stageid="bc1f3f72-34c5-43e2-850e-d4446d82dfa3" name="Reset Count" type="Calculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="390" w="90" h="60" />
    <onsuccess>ec9224d7-a028-40cf-af9b-09597e165f6e</onsuccess>
    <calculation expression="0" stage="nu_ExceptionCount" />
  </stage>
  <stage stageid="212b598d-7cb3-443e-8279-cbaa8ef4824b" name="HTTP Request" type="Action">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="255" />
    <inputs>
      <input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="&quot;URL Webhook Avisos&quot;" />
      <input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="[Body Webhook Avisos]" />
      <input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" />
      <input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="" />
      <input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" />
      <input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" />
      <input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" />
      <input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="" />
      <output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="" />
    </outputs>
    <onsuccess>26aed340-e5ef-4475-8aba-b48c1b43f68f</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="e15f435b-562f-4c4f-9d6c-34713cb767c8" name="Replaces" type="MultipleCalculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="180" w="90" h="60" />
    <onsuccess>212b598d-7cb3-443e-8279-cbaa8ef4824b</onsuccess>
    <steps>
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE1&quot;,[str_process])" stage="Body Webhook Avisos" />
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE2&quot;,&quot;ERRO NO PROCESSAMENTO&quot;)" stage="Body Webhook Avisos" />
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE3&quot;,&quot;Trocar para o IP da VM&quot;)" stage="Body Webhook Avisos" />
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE4&quot;,[str_nmuser])" stage="Body Webhook Avisos" />
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE5&quot;,[05121_IP_VM])" stage="Body Webhook Avisos" />
      <calculation expression="Replace([Body Webhook Avisos],&quot;VALUE6&quot;,[Exception Detail])" stage="Body Webhook Avisos" />
    </steps>
  </stage>
  <stage stageid="48002621-8244-4184-a058-7ab51e132504" name="Update PostgreSQL" type="SubSheet">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="120" y="90" w="90" h="60" />
    <inputs>
      <input type="text" name="StatusJob" friendlyname="StatusJob" expr="&quot;Falha - Sistema&quot;" />
      <input type="text" name="ExecutionTime" friendlyname="ExecutionTime" expr="[str_timeExec]" />
      <input type="text" name="Note" friendlyname="Note" expr="[Exception Detail]" />
      <input type="number" name="Status" friendlyname="Status" expr="5" />
    </inputs>
    <onsuccess>e15f435b-562f-4c4f-9d6c-34713cb767c8</onsuccess>
    <processid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</processid>
  </stage>
  <stage stageid="1882f47a-d9df-4ae3-ae57-10c2655e033a" name="nu_ExceptionLimit" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="-15" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>3</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5d1d50a7-e388-4f85-a3a7-117260f3ef7e" name="nu_ExceptionCount" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="-45" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
  </stage>
  <stage stageid="df9ffc4c-3043-4dcb-96d3-fc96bb745ffe" name="str_LastException" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="011a0ea5-4d4d-428d-ad68-6ec17b2055a1" name="Body Webhook Avisos" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="75" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">{
"@context": "https://schema.org/extensions",
"@type": "MessageCard",
"themeColor": "AA0000",
"title": "Processo Template Avisos",
"text": "VALUE1",
"sections": [
{
"facts": [
{
"name": "Status:",
"value": "VALUE2"
},
{
"name": "Virtual Machine:",
"value": "VALUE3"
},
{
"name": "User:",
"value": "VALUE4"
},
{
"name": "ID do Processamento:",
"value": "VALUE5"
},
{
"name": "Detalhes do Erro:",
"value": "VALUE6"
}
],
"text": ""
}
],
}</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f7f23cb1-3895-486a-8c22-a5439044944c" name="Update PostgreSQL" type="SubSheet">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="285" y="180" w="90" h="60" />
    <inputs>
      <input type="text" name="StatusJob" friendlyname="StatusJob" expr="&quot;Arquivo pendente de download&quot;" />
      <input type="text" name="ExecutionTime" friendlyname="ExecutionTime" expr="[str_timeExec]" />
      <input type="text" name="Note" friendlyname="Note" expr="[str_observacao]" />
      <input type="number" name="Status" friendlyname="Status" expr="6" />
    </inputs>
    <onsuccess>7e5fc446-a081-4136-9320-64a2673ec570</onsuccess>
    <processid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</processid>
  </stage>
  <stage stageid="35fb6e3b-9f4f-4fda-b83d-bc97434c4765" name="Credential Postgres" type="Calculation">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-210" />
    <onsuccess>629852e9-d4c8-47d6-835a-f3ad9376f572</onsuccess>
    <calculation expression="&quot;05121_Postgres_KitDesligamento&quot;" stage="Credencial - Postgre" />
  </stage>
  <stage stageid="629852e9-d4c8-47d6-835a-f3ad9376f572" name="Get Credentials" type="Action">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="15" y="-150" w="90" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credencial - Postgre]" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>c939b6f8-fdc7-4a6a-b53a-a0c857a9e95a</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="4b29bcd8-a7fa-417e-9cb2-2fd48e7d6a4a" name="Stopping Control Settings" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-390" y="645" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="e4866db2-1bfd-48e3-8cdc-42b378a498c0" name="Stop After Time" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="675" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
    <datatype>time</datatype>
    <initialvalue>00:00:00</initialvalue>
    <exposure>Session</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a5150c8c-3810-4e65-a3aa-5649b50f4931" name="Status Fila" type="Calculation">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-60" />
    <onsuccess>92a273ff-a150-4d1c-9f0e-ad2d2cfbd1dc</onsuccess>
    <calculation expression="&quot;3&quot;" stage="str_status" />
  </stage>
  <stage stageid="67e641e9-c91b-4601-9151-a13c196c9a37" name="Update PostgreSql" type="SubSheet">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-135" w="90" h="60" />
    <inputs>
      <input type="text" name="StatusJob" friendlyname="StatusJob" expr="[str_status]" />
      <input type="text" name="ExecutionTime" friendlyname="ExecutionTime" expr="[str_timeExec]" />
      <input type="text" name="Note" friendlyname="Note" expr="&quot;&quot;" />
      <input type="number" name="Status" friendlyname="Status" expr="3" />
    </inputs>
    <onsuccess>a5150c8c-3810-4e65-a3aa-5649b50f4931</onsuccess>
    <processid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</processid>
  </stage>
  <stage stageid="a68d4eea-37c4-43b4-88e2-c8626127f58e" name="Set Variables" type="MultipleCalculation">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-225" w="90" h="60" />
    <onsuccess>67e641e9-c91b-4601-9151-a13c196c9a37</onsuccess>
    <steps>
      <calculation expression="FormatDateTime(Now()- MakeTimeSpan(0, 3, 0, 0),&quot;yyyy-MM-dd HH:mm:ss&quot;)" stage="str_endTime" />
      <calculation expression="&quot;Completed&quot;" stage="str_status" />
      <calculation expression="ToDateTime([str_endTime]) - ToDateTime([str_updateTime])" stage="str_timeExec" />
      <calculation expression="Replace([str_timeExec], &quot;0.&quot;, &quot;&quot;)" stage="str_timeExec" />
    </steps>
  </stage>
  <stage stageid="63bfbeb5-53fd-497f-bc6b-82f5a06c8e90" name="str_timeExec" type="Data">
    <subsheetid>325a4f14-9840-42e5-95ad-c38be9fca219</subsheetid>
    <display x="-225" y="-135" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d2b43fc9-b6e6-4b8c-a7d1-a501773112e1" name="str_tabelaPostgre" type="Data">
    <subsheetid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</subsheetid>
    <display x="-270" y="75" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e59756f7-6480-4eed-9515-31503f872947" name="Terminate" type="Block">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-105" w="195" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="80c085f0-a395-4932-a340-a505fe035f32" name="Recover" type="Recover">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit />
    <display x="105" y="-75" />
    <onsuccess>693e02f0-cb8f-4d17-a1c8-789859b306e1</onsuccess>
  </stage>
  <stage stageid="693e02f0-cb8f-4d17-a1c8-789859b306e1" name="Resume" type="Resume">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit />
    <display x="105" y="-15" />
    <onsuccess>5cf399c4-7c49-40ab-8f9a-dc9de559958f</onsuccess>
  </stage>
  <stage stageid="ca3d7cf9-cf36-44b4-8047-d4c562154f17" name="Terminate" type="Block">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="15" w="195" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ce150fb3-43f8-4db1-a37e-5178cf9434c1" name="Recover" type="Recover">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit />
    <display x="105" y="45" />
    <onsuccess>0b71be49-a4a8-407a-bbcd-10a81885436b</onsuccess>
  </stage>
  <stage stageid="0b71be49-a4a8-407a-bbcd-10a81885436b" name="Resume" type="Resume">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit />
    <display x="105" y="105" />
    <onsuccess>0240232b-e389-4435-b060-3222c2279d2e</onsuccess>
  </stage>
  <stage stageid="19b8a22b-12f0-4148-82cc-f02c7d2d6aba" name="All Files Downloaded ?" type="Decision">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="15" y="435" w="120" h="30" />
    <decision expression="[fl_all_Files_Downloaded]" />
    <ontrue>250c578e-7467-4db5-a0d2-a76c9275f58e</ontrue>
    <onfalse>5f77711d-06cd-4215-988a-48b2cbad2144</onfalse>
  </stage>
  <stage stageid="f2250b59-4ff3-4dc7-8262-d4a42395fb23" name="NOK" type="Calculation">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="375" />
    <onsuccess>ab88773e-ef80-40b4-8dc6-e712510ae29e</onsuccess>
    <calculation expression="False" stage="fl_all_Files_Downloaded" />
  </stage>
  <stage stageid="251bd42d-f2d1-4c15-a559-1fcb1a46373e" name="GetFiles" type="Action">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="195" w="90" h="30" />
    <inputs>
      <input type="text" name="Folder" friendlyname="Folder" narrative="The folder in which to look for files" expr="[str_pathUsuarioAtual]" />
      <input type="text" name="Patterns CSV" friendlyname="Patterns CSV" narrative="The comma seperated list of wildcard patterns" expr="[str_filePattern]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="" />
      <output type="text" name="Message" friendlyname="Message" narrative="A message if unsuccessful" stage="" />
      <output type="collection" name="Files" friendlyname="Files" narrative="The collection of files found" stage="col_files" />
    </outputs>
    <onsuccess>28ea640c-d886-48c3-aed8-c38c6ab454b2</onsuccess>
    <resource object="Utility - File Management" action="Get Files" />
  </stage>
  <stage stageid="e2a72c72-d79b-4e46-9717-f20aa9586403" name="Business Exception" type="Exception">
    <subsheetid>12a17449-7e72-40ac-9f5c-3ab2c498c5af</subsheetid>
    <display x="60" y="555" />
    <exception localized="yes" type="Business Exception" detail="&quot;4 -ID padrão de motivo, não se enquadra na regra especificada.&quot;" />
  </stage>
  <stage stageid="12fb7461-20cf-4a13-af5b-481634841e28" name="2.4 - Directory Checker" type="SubSheetInfo">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="-195" w="150" h="90" />
  </stage>
  <stage stageid="61cb3772-1e0c-41d4-b363-98571949e707" name="Start" type="Start">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="15" y="-225" />
    <onsuccess>a22380cb-2aaf-4b5c-a54c-2876bdb554ec</onsuccess>
  </stage>
  <stage stageid="36270a9b-5ca8-4dc1-9f22-b3d2071fa1e2" name="End" type="End">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="15" y="330" />
    <outputs>
      <output type="flag" name="Downloaded File" stage="out_fl_downloaded_File" />
    </outputs>
  </stage>
  <stage stageid="fb19533d-6ad1-4974-a685-aeae6e7361e3" name="Delete ALL Files Download" type="Action">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="15" w="90" h="30" />
    <inputs>
      <input type="text" name="Folder" friendlyname="Folder" narrative="The path from which to delete the files" expr="[05121_ExtracaoPathDownload]" />
      <input type="text" name="Pattern" friendlyname="Pattern" narrative="The wildcard pattern of files to delete" expr="&quot;*.*&quot;" />
    </inputs>
    <onsuccess>0b983c41-c2da-43ac-bd1a-f0a965c3b74e</onsuccess>
    <resource object="Utility - File Management" action="Delete Files" />
  </stage>
  <stage stageid="a8c21d64-b1be-4fff-801d-0f8d42b4609f" name="Get Files" type="Action">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Folder" friendlyname="Folder" narrative="The folder in which to look for files" expr="[05121_ExtracaoPathDownload]" />
      <input type="text" name="Patterns CSV" friendlyname="Patterns CSV" narrative="The comma seperated list of wildcard patterns" expr="&quot;*.PDF&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_sucess" />
      <output type="text" name="Message" friendlyname="Message" narrative="A message if unsuccessful" stage="str_message" />
      <output type="collection" name="Files" friendlyname="Files" narrative="The collection of files found" stage="col_files" />
    </outputs>
    <onsuccess>08cbcb62-645e-41b2-8118-2b33c8393240</onsuccess>
    <resource object="Utility - File Management" action="Get Files" />
  </stage>
  <stage stageid="b7ebd0be-5780-4a32-8513-998fed1aa200" name="fl_sucess" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="90" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2115d5cf-7104-4d99-882d-a3e9b81c8e96" name="str_message" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1136b02f-14ca-4a04-b313-2982d47e6301" name="col_files" type="Collection">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="-15" w="120" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="08cbcb62-645e-41b2-8118-2b33c8393240" name="Count" type="Action">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;col_files&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="Count" friendlyname="Count" narrative="The number of rows counted in the collection" stage="num_countFiles" />
    </outputs>
    <onsuccess>1c6e5b99-9565-492f-9173-d73b0a8f3ca8</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" />
  </stage>
  <stage stageid="d050c74f-ba3f-452d-8f90-c38c2895c65e" name="num_countFiles" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="135" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1c6e5b99-9565-492f-9173-d73b0a8f3ca8" name="Exist Item ?" type="Decision">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="15" y="60" w="90" h="60" />
    <decision expression="[num_countFiles] &gt;= 1" />
    <ontrue>6f92cd78-1157-4da0-9f90-fbbecbe26865</ontrue>
    <onfalse>e428a046-3d68-42b4-92af-b541be490246</onfalse>
  </stage>
  <stage stageid="e428a046-3d68-42b4-92af-b541be490246" name="Limit ?" type="Decision">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="150" y="60" w="90" h="30" />
    <decision expression="[Retry count] = [Retry Limit]" />
    <ontrue>223a32e0-0eca-4827-8639-72ddfac4add8</ontrue>
    <onfalse>acad6060-c138-4ab0-840f-dea1cad1309f</onfalse>
  </stage>
  <stage stageid="2073f8b6-9126-4510-9bc8-7bce1cb6c01f" name="Count ++" type="Calculation">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-75" />
    <onsuccess>a8c21d64-b1be-4fff-801d-0f8d42b4609f</onsuccess>
    <calculation expression="[Retry count] + 1" stage="Retry count" />
  </stage>
  <stage stageid="9b8ee843-ed20-4ab5-af3e-e5716c24249a" name="2.4 - Directory Checker" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="180" w="90" h="60" />
    <outputs>
      <output type="flag" name="Downloaded File" friendlyname="Downloaded File" stage="fl_fileDownloaded" />
    </outputs>
    <onsuccess>78540f9a-0df2-41b8-bbbb-6e49cca85838</onsuccess>
    <processid>9e0f57ec-f060-4d75-9743-b787b11d4d46</processid>
  </stage>
  <stage stageid="6f92cd78-1157-4da0-9f90-fbbecbe26865" name="Move File" type="Action">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" />
    <inputs>
      <input type="text" name="File Path" friendlyname="File Path" narrative="The full path to the file to move" expr="[col_files.Path]" />
      <input type="text" name="Destination Path" friendlyname="Destination Path" narrative="The path to the folder to move the file to" expr="[str_pathUsuarioAtual]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_sucess" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>854a6367-173f-4c15-b4e4-536bb401107c</onsuccess>
    <resource object="Utility - File Management" action="Move File" />
  </stage>
  <stage stageid="ca035132-a2e5-4544-8d8a-b258dbadf527" name="APP2 - SAP - Acess Transction" type="SubSheetInfo">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="-285" w="150" h="90" />
  </stage>
  <stage stageid="e65741b5-bca1-438e-ae37-086eaa4a2387" name="Start" type="Start">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="15" y="-315" />
    <onsuccess>b280866f-6c13-4978-bf0d-de6a119f0675</onsuccess>
  </stage>
  <stage stageid="31b48bdd-2963-495b-8c3a-46b9b8d03097" name="End" type="End">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="00d99eb6-e95f-45e1-909f-f580cebfcc9a" name="Launch (or Attach)" type="Action">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <outputs>
      <output type="flag" name="Attach" friendlyname="Attach" stage="fl_attached" />
    </outputs>
    <onsuccess>f2731a2b-1c97-4dae-877e-29e1c1ade966</onsuccess>
    <resource object="SAP" action="Launch (or Attach)" />
  </stage>
  <stage stageid="f2731a2b-1c97-4dae-877e-29e1c1ade966" name="Attached ?" type="Decision">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="15" y="15" w="90" h="30" />
    <decision expression="[fl_attached]" />
    <ontrue>c9dfb1b1-0d57-4f05-b2c6-2b4fc5df5ce6</ontrue>
    <onfalse>ed80ba1e-e66c-4ed8-bc85-cdecbaa53cbc</onfalse>
  </stage>
  <stage stageid="ed80ba1e-e66c-4ed8-bc85-cdecbaa53cbc" name="System Exception" type="Exception">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="105" y="15" />
    <exception localized="yes" type="System Exception" detail="&quot;5 - Não foi possível efetivar a ação Launch no SAP&quot;" />
  </stage>
  <stage stageid="c9dfb1b1-0d57-4f05-b2c6-2b4fc5df5ce6" name="Login" type="Action">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Mandante" friendlyname="Mandante" expr="[str_mandante]" />
      <input type="text" name="Usuario" friendlyname="Usuario" expr="[str_usuarioSap]" />
      <input type="password" name="Senha" friendlyname="Senha" expr="[psw_senhaSap]" />
    </inputs>
    <onsuccess>aedf586c-5452-4324-bff6-eeecbf1ca668</onsuccess>
    <resource object="SAP" action="2.0 - Login SAP" />
  </stage>
  <stage stageid="aedf586c-5452-4324-bff6-eeecbf1ca668" name="Select Transaction" type="Action">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" w="90" h="30" />
    <inputs>
      <input type="text" name="Transacao" friendlyname="Transacao" expr="[str_transaction]" />
    </inputs>
    <onsuccess>31b48bdd-2963-495b-8c3a-46b9b8d03097</onsuccess>
    <resource object="SAP" action="2.1 - Select Transaction" />
  </stage>
  <stage stageid="c2a1ca93-2a4c-4870-8e94-22efa4bafd4d" name="APP2 - SAP - Acess Transction" type="SubSheet">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="150" w="90" h="60" />
    <onsuccess>74975820-4121-43f5-b8c7-130654dc6cb0</onsuccess>
    <processid>902b1f5d-41c6-4133-8824-908cffd0cfa3</processid>
  </stage>
  <stage stageid="db2e7845-c451-4732-8071-45a2508bcd40" name="APP1 - Minha Via" type="SubSheetInfo">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="-195" y="-225" w="150" h="90" />
  </stage>
  <stage stageid="438b39f1-9016-4cec-897b-4248105f72ae" name="Start" type="Start">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="15" y="-255" />
    <onsuccess>7f38e1f8-d07d-44a3-8c50-8bd50212ba00</onsuccess>
  </stage>
  <stage stageid="9c872c2a-14d5-404d-b96d-246d5e92ffbd" name="End" type="End">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="15" y="135" />
  </stage>
  <stage stageid="4d23b042-e34e-4fcb-8152-a8ae82aa733c" name="Launch and Login" type="Action">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="90" h="30" />
    <inputs>
      <input type="text" name="Usuario" friendlyname="Usuario" expr="[str_usuario]" />
      <input type="password" name="Senha" friendlyname="Senha" expr="[psw_senha]" />
    </inputs>
    <onsuccess>98863ef3-36c9-4a79-9269-2114db178cd4</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="Login" />
  </stage>
  <stage stageid="98863ef3-36c9-4a79-9269-2114db178cd4" name="Acessar URL" type="Action">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="URL" friendlyname="URL" expr="[str_url]" />
    </inputs>
    <onsuccess>9c872c2a-14d5-404d-b96d-246d5e92ffbd</onsuccess>
    <resource object="Minha VIA - Extracao Relatorio" action="URL - Pesquisa" />
  </stage>
  <stage stageid="ffdf708c-6ccc-4069-a508-e4b64be6ff1e" name="str_url" type="Data">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="-195" y="15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a9b8999b-af3b-4672-bcce-2256505e6d7c" name="Local Variables" type="Block">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-15" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="847e4305-33b5-4aac-b99a-56909b68ae82" name="APP 1" type="Block">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-135" w="210" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5e26c755-931f-486c-b759-f77d6ff6341f" name="Recover" type="Recover">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit />
    <display x="105" y="75" />
    <onsuccess>c10c8591-5dc7-49fb-8461-08d5456825f0</onsuccess>
  </stage>
  <stage stageid="c10c8591-5dc7-49fb-8461-08d5456825f0" name="Throw" type="Exception">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="195" y="75" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="ad723a2d-f336-4557-a340-8fd379bc573d" name="Kill Process" type="Action">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="[str_processApplication]" />
    </inputs>
    <onsuccess>4d23b042-e34e-4fcb-8152-a8ae82aa733c</onsuccess>
    <resource object="Utility - Environment" action="Kill Process" />
  </stage>
  <stage stageid="13e9efe3-0153-4111-aa22-7f0657783797" name="APP2" type="Block">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-195" w="210" h="360" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="fc5796ac-66aa-46fc-b113-088dabb4c91a" name="Recover" type="Recover">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit />
    <display x="105" y="75" />
    <onsuccess>fc0d6ea3-f194-498e-9951-a62afe2c281c</onsuccess>
  </stage>
  <stage stageid="fc0d6ea3-f194-498e-9951-a62afe2c281c" name="Throw" type="Exception">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="195" y="75" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="d28597cf-b074-4710-8ba9-1856f3247a30" name="Directory" type="Block">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="-15" w="210" h="330" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="615d4bd7-d22d-46e4-ab3e-986fcbff3a3a" name="Recover" type="Recover">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit />
    <display x="75" y="15" />
    <onsuccess>91caf934-1ab2-40a7-8d9f-8967dc982f86</onsuccess>
  </stage>
  <stage stageid="91caf934-1ab2-40a7-8d9f-8967dc982f86" name="Throw" type="Exception">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <display x="165" y="15" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="9b7cc4d2-6e40-4f79-adcb-ae55cc6be653" name="psw_senha" type="Data">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="-195" y="-60" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
  </stage>
  <stage stageid="d305ed78-f9f7-480c-81b3-0bea03800526" name="str_usuario" type="Data">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <display x="-195" y="-90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
  </stage>
  <stage stageid="a29dab5a-e2a9-4c08-86e2-a2e8629e939c" name="Credentials APP1 - MINHA VIA" type="Block">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-165" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF00" />
  </stage>
  <stage stageid="96fcca18-cd9d-4e03-8fd9-f77ebd8a9c2a" name="str_mandante" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="-45" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2343b252-0a45-4596-a38b-c4961392b794" name="str_transaction" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="0" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b280866f-6c13-4978-bf0d-de6a119f0675" name="Set Variables" type="MultipleCalculation">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-240" w="90" h="60" />
    <onsuccess>ed6a7a15-9365-43e0-af7b-9e03ed63fa9a</onsuccess>
    <steps>
      <calculation expression="&quot;05121_Credentials SAP&quot;" stage="Credencial - SAP" />
      <calculation expression="&quot;100&quot;" stage="str_mandante" />
      <calculation expression="&quot;ZHCMTR0047&quot;" stage="str_transaction" />
    </steps>
  </stage>
  <stage stageid="97f00631-06ad-42fd-b907-9902e582f5ba" name="Credencial - Minha Via" type="Data">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit />
    <display x="-195" y="-135" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7f38e1f8-d07d-44a3-8c50-8bd50212ba00" name="Set Variables" type="MultipleCalculation">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-180" w="90" h="60" />
    <onsuccess>e65da955-beb2-4061-9e8d-d43290f8fc85</onsuccess>
    <steps>
      <calculation expression="&quot;05121_Credentials Minha VIA Site&quot;" stage="Credencial - Minha Via" />
      <calculation expression="&quot;https://hcm19.sapsf.com/xi/ui/documentgeneration/pages/generator.xhtml?&amp;_s.crb=7DpIPUAiQoTih9H78m79CDV3hM072%2bB6fdtomc9R0JI%3d&quot;" stage="str_url" />
    </steps>
  </stage>
  <stage stageid="2ea08f3a-6089-4bf9-b24f-4ce09df86913" name="fl_attached" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="45" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8317162a-1093-44e5-88e7-f8262ea900f5" name="Credencial - SAP" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-195" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="83cb21c6-9a91-46f6-9131-4f02adc899dc" name="Credentials  APP 2 - SAP" type="Block">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit />
    <display x="-270" y="-225" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF00" />
  </stage>
  <stage stageid="3f8859c3-eafd-4987-bed0-83a90ed79d70" name="str_usuarioSap" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="-150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9b696465-4bde-437f-8372-955cfbaa4d60" name="psw_senhaSap" type="Data">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <display x="-195" y="-120" w="120" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="62d816f9-3384-485d-836f-1cf398a8c381" name="Local Variables" type="Block">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit />
    <display x="-270" y="-75" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="00CCFF" />
  </stage>
  <stage stageid="ed6a7a15-9365-43e0-af7b-9e03ed63fa9a" name="Get - Credentials" type="Action">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="15" y="-165" w="90" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credencial - SAP]" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="psw_senhaSap" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="str_usuarioSap" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>fcfed960-c9d2-4940-95ef-63dff58a88a9</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="fcfed960-c9d2-4940-95ef-63dff58a88a9" name="Kill Process" type="Action">
    <subsheetid>902b1f5d-41c6-4133-8824-908cffd0cfa3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="text" name="Process Name" friendlyname="Process Name" narrative="The name of the process to kill" expr="[str_applicationSap]" />
    </inputs>
    <onsuccess>00d99eb6-e95f-45e1-909f-f580cebfcc9a</onsuccess>
    <resource object="Utility - Environment" action="Kill Process" />
  </stage>
  <stage stageid="8782c636-d3a7-4329-9f16-07cbd10d7413" name="Anchor11" type="Anchor">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="75" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF00" />
    <onsuccess>c2a1ca93-2a4c-4870-8e94-22efa4bafd4d</onsuccess>
  </stage>
  <stage stageid="b557cb17-aaad-48ec-8213-126ac3402425" name="SAP - DOWNLOAD DAP" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="180" w="90" h="60" />
    <onsuccess>8ee7eb41-91a6-49d5-90b5-07289b5c6334</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>60d66175-084d-4059-90a9-02368c860d5a</processid>
  </stage>
  <stage stageid="3dc714ee-deab-42e9-9b03-ef5465105278" name="APP1 - Minha Via" type="SubSheet">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="90" h="60" />
    <onsuccess>9536ec9f-a32e-4565-b5fa-11a704ede298</onsuccess>
    <processid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</processid>
  </stage>
  <stage stageid="ccfc0489-e122-4925-99bc-9491b10170fa" name="Local Variables" type="Block">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-60" w="150" h="225" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="22149a2f-8e18-42de-878c-6bb8e298f94a" name="Retry count" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="210" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>0</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dc5c3ada-b6a9-4511-9e48-b3d036ea097f" name="Retry Limit" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="240" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue>3</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="31871b4b-fd3e-491d-8b7d-292e84a1ab78" name="Treatment And Exceptions" type="Block">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="180" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="a22380cb-2aaf-4b5c-a54c-2876bdb554ec" name="Set Variables" type="MultipleCalculation">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-150" w="90" h="60" />
    <onsuccess>a8c21d64-b1be-4fff-801d-0f8d42b4609f</onsuccess>
    <steps>
      <calculation expression="0" stage="Retry count" />
      <calculation expression="3" stage="Retry Limit" />
      <calculation expression="10" stage="num_Sleep" />
    </steps>
  </stage>
  <stage stageid="4404b418-8b17-4c29-8779-799581121c22" name="Validation" type="Block">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="e6677795-be4a-4b83-bc16-acc4bed42cfc" name="fl_all_Files_Downloaded" type="Data">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-15" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f03aa5f3-9608-471d-a60a-d8dc8b8464b5" name="Status OK" type="Calculation">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="315" />
    <onsuccess>ab88773e-ef80-40b4-8dc6-e712510ae29e</onsuccess>
    <calculation expression="&quot;OK&quot;" stage="Lista Documentos.status" />
  </stage>
  <stage stageid="acad6060-c138-4ab0-840f-dea1cad1309f" name="Sleep" type="Action">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-15" w="90" h="30" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="[num_Sleep]" />
    </inputs>
    <onsuccess>2073f8b6-9126-4510-9bc8-7bce1cb6c01f</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="98e91a70-9078-4bc6-909a-46e3cdee3454" name="num_Sleep" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="285" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="71ee583e-ff22-4397-a553-214e89ba670b" name="Output" type="Block">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-135" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993300" />
  </stage>
  <stage stageid="6ccc6a2e-f1be-4fc7-a114-441baefb0ecb" name="out_fl_downloaded_File" type="Data">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="-195" y="-105" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="62a76969-03a5-4590-bf6e-ebf05e34e5db" name="True" type="Calculation">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="270" />
    <onsuccess>36270a9b-5ca8-4dc1-9f22-b3d2071fa1e2</onsuccess>
    <calculation expression="True" stage="out_fl_downloaded_File" />
  </stage>
  <stage stageid="00976681-b790-4f73-83bf-ce6e07ea9a04" name="False" type="Calculation">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="330" />
    <onsuccess>36270a9b-5ca8-4dc1-9f22-b3d2071fa1e2</onsuccess>
    <calculation expression="False" stage="out_fl_downloaded_File" />
  </stage>
  <stage stageid="78540f9a-0df2-41b8-bbbb-6e49cca85838" name="Downloaded" type="Decision">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="15" y="255" w="90" h="30" />
    <decision expression="[fl_fileDownloaded]" />
    <ontrue>f03aa5f3-9608-471d-a60a-d8dc8b8464b5</ontrue>
    <onfalse>b9e30e00-2e52-4392-b207-1010319cbb36</onfalse>
  </stage>
  <stage stageid="1d50acc8-2dac-498d-b319-46384aa193e0" name="BusinessException" type="Exception">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <display x="270" y="435" w="90" h="30" />
    <exception localized="yes" type="BusinessException" detail="&quot;6 - Falha - Arquivo pendente de download&quot;" />
  </stage>
  <stage stageid="5f77711d-06cd-4215-988a-48b2cbad2144" name="3 - Move To Exception Folder" type="SubSheet">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="435" w="90" h="60" />
    <onsuccess>1d50acc8-2dac-498d-b319-46384aa193e0</onsuccess>
    <processid>6e7a8a41-35f8-4414-af93-40472565e079</processid>
  </stage>
  <stage stageid="2cf7ddab-7d3b-4a9a-96db-48c4ac076b01" name="Anchor12" type="Anchor">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="15" w="10" h="10" />
    <onsuccess>b557cb17-aaad-48ec-8213-126ac3402425</onsuccess>
  </stage>
  <stage stageid="8ee7eb41-91a6-49d5-90b5-07289b5c6334" name="Anchor13" type="Anchor">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="255" w="10" h="10" />
    <onsuccess>78540f9a-0df2-41b8-bbbb-6e49cca85838</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="b9e30e00-2e52-4392-b207-1010319cbb36" name="Anchor14" type="Anchor">
    <subsheetid>52955815-5669-4aa5-a7b9-d5ce7ac77aa1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-90" y="255" w="10" h="10" />
    <onsuccess>f2250b59-4ff3-4dc7-8262-d4a42395fb23</onsuccess>
  </stage>
  <stage stageid="6c906c53-4fe7-47b8-8cd3-7617ab2003c9" name="Create Directory" type="Action">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
    <inputs>
      <input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[str_pathUsuarioError]" />
      <input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_success" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>5b9843fa-9d74-49c3-9d5b-cb000d35e55d</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="339955f6-07eb-41e6-87e5-72684957a2f1" name="nome_pasta" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f497afc3-0c41-4500-afc5-f7a8be724d04" name="\ Ao fim ?" type="Decision">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="15" y="-75" w="90" h="30" />
    <decision expression="EndsWith([05121_ExtracaoNaoProcessado], &quot;\&quot;)" />
    <ontrue>6fd15bfc-d51b-44eb-a191-6bc94fbb1502</ontrue>
    <onfalse>e8c4e68f-290e-4063-872c-23a13e0005ae</onfalse>
  </stage>
  <stage stageid="97885dfb-8b19-462f-b54a-f8a55447ac37" name="Create Directory" type="Action">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="45" />
    <inputs>
      <input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path in which to create the directory" expr="[str_pathUsuarioError]" />
      <input type="flag" name="Error If Already Exists" friendlyname="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_success" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>cae4d7f7-a648-4505-b736-2f89253e753c</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="e8c4e68f-290e-4063-872c-23a13e0005ae" name="Anchor7" type="Anchor">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-75" w="10" h="10" />
    <onsuccess>4c89e14b-ee11-4e1a-bd07-2a61bfcf505b</onsuccess>
  </stage>
  <stage stageid="5b9843fa-9d74-49c3-9d5b-cb000d35e55d" name="Anchor7" type="Anchor">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="90" w="10" h="10" />
    <onsuccess>4530367e-500a-4c27-b04d-39a7b117b8e6</onsuccess>
  </stage>
  <stage stageid="cae4d7f7-a648-4505-b736-2f89253e753c" name="Anchor7" type="Anchor">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="90" w="10" h="10" />
    <onsuccess>5b9843fa-9d74-49c3-9d5b-cb000d35e55d</onsuccess>
  </stage>
  <stage stageid="57987bf8-8e4f-4248-a238-b1eed1607c96" name="fl_success" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="165" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d92c2d5c-7b00-4d37-ac66-a84b03e8e56d" name="str_message" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="210" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4530367e-500a-4c27-b04d-39a7b117b8e6" name="Directory Created ?" type="Decision">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="15" y="135" w="90" h="30" />
    <decision expression="[fl_success]" />
    <ontrue>251bd42d-f2d1-4c15-a559-1fcb1a46373e</ontrue>
    <onfalse>880074a0-cd2d-45a7-9f67-baf56b24ae40</onfalse>
  </stage>
  <stage stageid="6fd15bfc-d51b-44eb-a191-6bc94fbb1502" name="PathUser" type="Calculation">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" />
    <onsuccess>6c906c53-4fe7-47b8-8cd3-7617ab2003c9</onsuccess>
    <calculation expression="[05121_ExtracaoNaoProcessado] &amp; [nome_pasta]&amp;&quot;_NOK&quot;" stage="str_pathUsuarioError" />
  </stage>
  <stage stageid="4c89e14b-ee11-4e1a-bd07-2a61bfcf505b" name="PathUser" type="Calculation">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-15" />
    <onsuccess>97885dfb-8b19-462f-b54a-f8a55447ac37</onsuccess>
    <calculation expression="[05121_ExtracaoNaoProcessado] &amp; &quot;\&quot; &amp;[nome_pasta] &amp;&quot;_NOK&quot;" stage="str_pathUsuarioError" />
  </stage>
  <stage stageid="880074a0-cd2d-45a7-9f67-baf56b24ae40" name="System Exception" type="Exception">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="120" y="135" />
    <exception localized="yes" type="System Exception" detail="&quot;Não foi possível criar o diretório do item: &quot; &amp; [Item Data.ID_Usuario_Colaborador]" />
  </stage>
  <stage stageid="b433d92b-2460-40b0-90c1-54eca75f2e1f" name="Directory" type="Block">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-75" y="-105" w="240" h="570" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5f2a7764-4e88-40cd-a4c9-32d962b06212" name="Recover" type="Recover">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit />
    <display x="120" y="195" />
    <onsuccess>ec42fa5a-891a-4575-96ba-65481858102a</onsuccess>
  </stage>
  <stage stageid="ec42fa5a-891a-4575-96ba-65481858102a" name="Throw" type="Exception">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="210" y="195" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="e65da955-beb2-4061-9e8d-d43290f8fc85" name="Get - Credentials" type="Action">
    <subsheetid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Credencial - Minha Via]" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="psw_senha" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="str_usuario" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>ad723a2d-f336-4557-a340-8fd379bc573d</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="0274b8d3-a3e3-46cb-bfea-39d69b8c13a8" name="Update PostgreSql" type="SubSheet">
    <subsheetid>c694c8c2-0e99-4e47-8381-768d45ad209a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="-75" w="90" h="60" />
    <inputs>
      <input type="text" name="StatusJob" friendlyname="StatusJob" expr="&quot;Em execução&quot;" />
      <input type="text" name="ExecutionTime" friendlyname="ExecutionTime" expr="FormatDateTime(Now()- MakeTimeSpan(0, 3, 0, 0),&quot;yyyy-MM-dd 00:00:00&quot;)" />
      <input type="text" name="Note" friendlyname="Note" expr="&quot;&quot;" />
      <input type="number" name="Status" friendlyname="Status" expr="2" />
    </inputs>
    <onsuccess>fb19533d-6ad1-4974-a685-aeae6e7361e3</onsuccess>
    <processid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</processid>
  </stage>
  <stage stageid="2a4f47aa-4928-46a1-949e-5e8456f5804f" name="SAP - Logout" type="Action">
    <subsheetid>838ed262-8e29-4c96-80e3-81eeeb98babd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" w="90" h="30" />
    <outputs>
      <output type="flag" name="Attach" friendlyname="Attach" stage="" />
    </outputs>
    <onsuccess>0240232b-e389-4435-b060-3222c2279d2e</onsuccess>
    <resource object="SAP" action="Terminate" />
  </stage>
  <stage stageid="5d96fa3c-7da6-4369-8c27-ab87b0e9674c" name="Delete Folder" type="SubSheetInfo">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="7267cb72-2b92-444a-ab64-285e193373b3" name="Start" type="Start">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="15" y="-135" />
    <inputs>
      <input type="text" name="Path" stage="str_path" />
    </inputs>
    <onsuccess>8b74a4c7-8c7d-4a41-b488-dbde47370c61</onsuccess>
  </stage>
  <stage stageid="7e3a660f-42db-4e18-adc7-d6134594ff91" name="End" type="End">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="15" y="45" />
  </stage>
  <stage stageid="8b74a4c7-8c7d-4a41-b488-dbde47370c61" name="Delete Directory" type="Action">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Directory Path" friendlyname="Directory Path" narrative="The path of the directory to delete" expr="[str_pathUsuarioAtual]" />
      <input type="flag" name="Error If Not Exists" friendlyname="Error If Not Exists" narrative="Set True to raise an error if the path does not exist" expr="False" />
      <input type="flag" name="Recursive" friendlyname="Recursive" narrative="Set True to delete all sub-directories of the path aswell" expr="False" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" narrative="True if successful" stage="fl_sucess" />
      <output type="text" name="Message" friendlyname="Message" narrative="An error message if unsuccessful" stage="str_message" />
    </outputs>
    <onsuccess>4c390f3c-ee19-4bfb-be5f-8d0ea85a38f2</onsuccess>
    <resource object="Utility - File Management" action="Delete Directory" />
  </stage>
  <stage stageid="c8f64ae4-66a9-4f75-9017-9b444d7fb508" name="str_message" type="Data">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="-195" y="60" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1965e7be-44d6-48f8-9e36-48494fac014a" name="fl_sucess" type="Data">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="-195" y="90" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="78d36501-25ff-4ee2-97f3-4b443e88e5b2" name="Delete Folder" type="SubSheet">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="240" y="105" />
    <inputs>
      <input type="text" name="Path" friendlyname="Path" expr="[str_pathUsuarioAtual]" />
    </inputs>
    <onsuccess>718fb012-b0fc-4763-ae35-8b93da1d4a63</onsuccess>
    <processid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</processid>
  </stage>
  <stage stageid="718fb012-b0fc-4763-ae35-8b93da1d4a63" name="Business Exception" type="Exception">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <display x="330" y="105" />
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <exception localized="yes" type="Business Exception" detail="&quot;4 - Usuario não encontrado.&quot;" />
  </stage>
  <stage stageid="0f8fff6c-0122-4d41-a4fc-e4b982c4792e" name="Teams Message Informativos" type="SubSheetInfo">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="497a77a4-d1d4-4951-a43a-52e7de2f69ea" name="Start" type="Start">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>6a6f9ca4-9e81-46ce-b5bf-28f02464eb7f</onsuccess>
  </stage>
  <stage stageid="e2497bc5-76ff-493d-8ab0-7752983b53c9" name="End" type="End">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="15" y="195" />
  </stage>
  <stage stageid="11b04261-67a3-4e26-97cf-4e41755699bd" name="HTTP Request" type="Action">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" w="90" h="30" />
    <inputs>
      <input type="text" name="Address URL" friendlyname="Address URL" narrative="The URL to send the HTTP data to" expr="[05121_URL_Webhook_Informativo]" />
      <input type="text" name="Body" friendlyname="Body" narrative="The body text of the HTTP request" expr="[Body Webhook Informativo]" />
      <input type="flag" name="Use Proxy" friendlyname="Use Proxy" narrative="Set true if you need to use a proxy" expr="" />
      <input type="text" name="Content Type" friendlyname="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" />
      <input type="text" name="Method" friendlyname="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" />
      <input type="text" name="Proxy URL" friendlyname="Proxy URL" narrative="OPTIONAL: The proxy url" expr="" />
      <input type="text" name="Proxy Username" friendlyname="Proxy Username" narrative="OPTIONAL: The proxy username" expr="" />
      <input type="password" name="Proxy Password" friendlyname="Proxy Password" narrative="OPTIONAL: The proxy password" expr="" />
      <input type="collection" name="Headers" friendlyname="Headers" narrative="OPTIONAL: Headers" expr="" />
      <input type="text" name="Accept" friendlyname="Accept" narrative="OPTIONAL: Accept" expr="" />
      <input type="text" name="Username" friendlyname="Username" narrative="OPTIONAL: Basic Authentication username" expr="" />
      <input type="password" name="Password" friendlyname="Password" narrative="OPTIONAL: Basic Authenction password" expr="" />
      <input type="text" name="Certificate ID" friendlyname="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" />
      <input type="flag" name="Force Pre Authorization" friendlyname="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" />
      <input type="flag" name="File URL" friendlyname="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="Result" friendlyname="Result" narrative="The result from the Post query." stage="Result" />
      <output type="text" name="Headers as Json" friendlyname="Headers as Json" narrative="The returned headers response as Json" stage="Headers as Json" />
    </outputs>
    <onsuccess>e2497bc5-76ff-493d-8ab0-7752983b53c9</onsuccess>
    <resource object="Utility - HTTP" action="HTTP Request" />
  </stage>
  <stage stageid="4e7bf59d-d57d-4023-821a-573859f63e9d" name="Replaces" type="MultipleCalculation">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="60" w="90" h="60" />
    <onsuccess>11b04261-67a3-4e26-97cf-4e41755699bd</onsuccess>
    <steps>
      <calculation expression="[Teams_Body Webhook Informativo]" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE0&quot;,&quot;Processo Kit de Desligamento( Consumidor )&quot;)" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE1&quot;,[str_process])" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE2&quot;,&quot;Iniciado&quot;)" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE3&quot;,[05121_IP_VM])" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE4&quot;,[str_nmuser])" stage="Body Webhook Informativo" />
      <calculation expression="Replace([Body Webhook Informativo],&quot;VALUE5&quot;,[Count Pending])&#xA;" stage="Body Webhook Informativo" />
    </steps>
  </stage>
  <stage stageid="f70abd47-5c36-4ffc-80a3-352c725a32b8" name="Message Teams" type="Block">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="333399" />
  </stage>
  <stage stageid="ce11ca0f-3e7c-44e1-a16e-82daff7f1497" name="Body Webhook Informativo" type="Data">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="d8232d9e-121d-4e82-a96e-28d5e4ae9f74" name="Headers as Json" type="Data">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="-195" y="30" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="e8e58de4-6def-4cfc-a350-151fa6be118e" name="Result" type="Data">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="-195" y="75" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="6a6f9ca4-9e81-46ce-b5bf-28f02464eb7f" name="Get Pending Items" type="Action">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Retrieves the IDs for all currently pending work queue items in the specified queue, matching the given tags</narrative>
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue for which the pending items are required" expr="[Queue Name]" />
      <input type="text" name="Key Filter" friendlyname="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" friendlyname="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
      <input type="number" name="Maximum" friendlyname="Maximum" narrative="Optionally, the maximum number of items to return. Default is to return all items" expr="" />
      <input type="number" name="Skip" friendlyname="Skip" narrative="Optionally, the number of items to skip before returning. Default is zero, ie. return all items from the head of the queue" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Pending Items" friendlyname="Pending Items" narrative="The currently pending items in the queue, referenced by ID. The single column is 'Item ID' : text. The elements in the collection will be in the order in which they will be loaded by the 'Get Next Item' action." stage="Pending Items" />
    </outputs>
    <onsuccess>aa02e240-2cef-460e-a455-1ccd00caa6a6</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Pending Items" />
  </stage>
  <stage stageid="6ca06478-b326-45e6-bc0b-64e4ed633ea4" name="Pending Items" type="Collection">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="-195" y="165" w="120" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" displayname="Item IDs" />
    </collectioninfo>
  </stage>
  <stage stageid="aa02e240-2cef-460e-a455-1ccd00caa6a6" name="Count Rows" type="Action">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Pending Items&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="Count" friendlyname="Count" narrative="The number of rows counted in the collection" stage="Count Pending" />
    </outputs>
    <onsuccess>4e7bf59d-d57d-4023-821a-573859f63e9d</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" />
  </stage>
  <stage stageid="a892d2f4-86d7-471b-a986-f28d450717e1" name="Count Pending" type="Data">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <display x="-195" y="225" w="120" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="439cd969-b04b-4e1b-942a-6eba92aaa737" name="Local Variables" type="Block">
    <subsheetid>4531fc13-a734-42d7-a055-0248921d4428</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="120" w="150" h="135" />
    <font family="Segoe UI" size="10" style="Regular" color="333399" />
  </stage>
  <stage stageid="c9219d41-a41f-46c1-8847-21bef4a00a05" name="Teams Message Informativos" type="SubSheet">
    <subsheetid>c3a06f9b-8b94-40a9-ae89-d1314f4004b4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="240" w="90" h="60" />
    <onsuccess>74975820-4121-43f5-b8c7-130654dc6cb0</onsuccess>
    <processid>4531fc13-a734-42d7-a055-0248921d4428</processid>
  </stage>
  <stage stageid="854a6367-173f-4c15-b4e4-536bb401107c" name="Moved ?" type="Decision">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <display x="15" y="195" w="90" h="30" />
    <decision expression="[fl_sucess]" />
    <ontrue>62a76969-03a5-4590-bf6e-ebf05e34e5db</ontrue>
    <onfalse>223a32e0-0eca-4827-8639-72ddfac4add8</onfalse>
  </stage>
  <stage stageid="223a32e0-0eca-4827-8639-72ddfac4add8" name="Anchor15" type="Anchor">
    <subsheetid>9e0f57ec-f060-4d75-9743-b787b11d4d46</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="195" w="10" h="10" />
    <onsuccess>00976681-b790-4f73-83bf-ce6e07ea9a04</onsuccess>
  </stage>
  <stage stageid="7d72399b-8bb3-4f71-91a6-80d6d7a9e781" name="05121_ExtracaoNaoProcessado" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-315" y="405" w="120" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="63b55408-b32e-476a-ba73-d6527770d832" name="APP1 - Minha Via" type="SubSheet">
    <subsheetid>acddfbca-7d9c-429a-bd93-bbdcae28f3f1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="240" y="-60" w="90" h="60" />
    <onsuccess>a8d1b08a-8eb0-47d7-a6a2-eb4a3d462161</onsuccess>
    <processid>141bd1a8-b3db-4b6d-abc0-530e42fbd66d</processid>
  </stage>
  <stage stageid="66af3a53-2b62-4f7a-93bc-136d34e05f29" name="str_pathUsuarioError" type="Data">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="-210" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="af3e7dea-bd0f-407e-9e52-552bfa3cdf6a" name="Set Variables" type="MultipleCalculation">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-150" w="90" h="60" />
    <onsuccess>f497afc3-0c41-4500-afc5-f7a8be724d04</onsuccess>
    <steps>
      <calculation expression="&quot;*PDF&quot;" stage="str_filePattern" />
      <calculation expression="[Item Data.ID_COLABORADOR]" stage="nome_pasta" />
    </steps>
  </stage>
  <stage stageid="1f8cceff-240a-4352-a1c5-178d4c447d4a" name="str_path" type="Data">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="657556d9-8625-466d-bb85-5c9235fba8d4" name="input" type="Block">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993300" />
  </stage>
  <stage stageid="11f1a88d-1b0f-47fa-94e1-092282096434" name="Treatment " type="Block">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
  </stage>
  <stage stageid="4c390f3c-ee19-4bfb-be5f-8d0ea85a38f2" name="Error ?" type="Decision">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="15" y="-15" w="90" h="30" />
    <decision expression="[fl_sucess]" />
    <ontrue>7e3a660f-42db-4e18-adc7-d6134594ff91</ontrue>
    <onfalse>82c33052-20f4-4e51-b91d-adb1ae2190a2</onfalse>
  </stage>
  <stage stageid="82c33052-20f4-4e51-b91d-adb1ae2190a2" name="System Exception" type="Exception">
    <subsheetid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</subsheetid>
    <display x="120" y="-15" />
    <exception localized="yes" type="System Exception" detail="&quot;5 - Não foi possível realizar a exclusão do diretório:&quot; &amp; [str_path]" />
  </stage>
  <stage stageid="1d883552-17b1-4240-91fc-1985d2d27c43" name="Delete Folder" type="SubSheet">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="510" w="90" h="60" />
    <inputs>
      <input type="text" name="Path" friendlyname="Path" expr="[str_pathUsuarioAtual]" />
    </inputs>
    <onsuccess>12bc22b4-3ec4-48b0-8aaa-44de05be2869</onsuccess>
    <processid>49c7e8d2-1f83-4496-ab74-3e0e8f2f43ce</processid>
  </stage>
  <stage stageid="f638e0c1-f5dc-4b97-b3ef-eeb420c6e586" name="Ausencia de Arquivo ?" type="Decision">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="285" y="0" w="90" h="60" />
    <decision expression="InStr([Exception Detail], &quot;6&quot;) &lt;&gt; 0" />
    <ontrue>bf3d1aef-db14-4891-8c4b-cdb84c2a8cd6</ontrue>
    <onfalse>0fe390d8-e142-4beb-97d3-277a3e23d195</onfalse>
  </stage>
  <stage stageid="fc59440a-2838-4dc5-959c-0f6e60ac2ba2" name="N.Encontrado" type="Calculation">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-15" />
    <onsuccess>4f156fb3-5022-4528-aec1-ba72c5d1a92f</onsuccess>
    <calculation expression="[str_mensagem]" stage="Lista Documentos.status" />
  </stage>
  <stage stageid="1ec84e19-eb43-4f9f-a151-2b26835ad34b" name="DAP Page" type="Action">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" w="90" h="30" />
    <onsuccess>563d67a7-e4ee-4ab4-8df4-a046680f6f7e</onsuccess>
    <resource object="SAP" action="DAP Page" />
  </stage>
  <stage stageid="c632506f-c8ae-455c-8a44-f8f295efdc05" name="Recover" type="Recover">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <loginhibit />
    <display x="120" y="-75" />
    <onsuccess>bad33bce-23e9-4bd1-a14a-f5d1f6db7d7c</onsuccess>
  </stage>
  <stage stageid="bad33bce-23e9-4bd1-a14a-f5d1f6db7d7c" name="Throw" type="Exception">
    <subsheetid>60d66175-084d-4059-90a9-02368c860d5a</subsheetid>
    <display x="210" y="-75" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="21b8dfa6-e1c8-41e8-8155-1c7d2e9f34c3" name="Moved ?" type="Decision">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <display x="15" y="375" w="90" h="30" />
    <decision expression="[fl_moved]" />
    <ontrue>96a85bb0-41ab-4304-bd95-8b9c72af91d7</ontrue>
    <onfalse>721c18de-a02f-4ca0-bfe7-efa8c8963aa5</onfalse>
  </stage>
  <stage stageid="721c18de-a02f-4ca0-bfe7-efa8c8963aa5" name="Anchor16" type="Anchor">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="375" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>2963fdf6-9876-4f15-88e0-1f98d32b9731</onsuccess>
  </stage>
  <stage stageid="2963fdf6-9876-4f15-88e0-1f98d32b9731" name="Anchor17" type="Anchor">
    <subsheetid>6e7a8a41-35f8-4414-af93-40472565e079</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="435" w="10" h="10" />
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>96a85bb0-41ab-4304-bd95-8b9c72af91d7</onsuccess>
  </stage>
  <stage stageid="db6cc8ab-a1ec-4a97-994f-1120663e6903" name="Note message" type="SubSheetInfo">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="22e9caa6-0ad5-4143-b488-258a45c22c12" name="Start" type="Start">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="15" y="-135" />
    <onsuccess>e737ed1b-d1cb-407f-8261-d643df94a1b5</onsuccess>
  </stage>
  <stage stageid="c9870965-ada8-4209-ba50-3842c9c827a7" name="End" type="End">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="15" y="165" />
    <outputs>
      <output type="text" name="observacao" stage="str_Itens" />
    </outputs>
  </stage>
  <stage stageid="6f57a79c-a9d5-4da1-9b44-543a311bd66c" name="Filter Collection" type="Action">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection In" friendlyname="Collection In" narrative="The collection to filter." expr="[temp]" />
      <input type="text" name="Filter" friendlyname="Filter" narrative="The filter query." expr="&quot;status like '&quot;&amp;&quot;NOK'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Out" friendlyname="Collection Out" narrative="The filtered collection." stage="temp" />
    </outputs>
    <onsuccess>2bc5d90d-dfaa-4e36-bbc5-1bea48b5c0d0</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Filter Collection" />
  </stage>
  <stage stageid="2bc5d90d-dfaa-4e36-bbc5-1bea48b5c0d0" name="Get Collection as CSV" type="Action">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" w="90" h="30" />
    <inputs>
      <input type="collection" name="Input Collection" friendlyname="Input Collection" narrative="The collection to be converted to CSV" expr="[temp]" />
    </inputs>
    <outputs>
      <output type="text" name="Collection CSV" friendlyname="Collection CSV" narrative="The CSV representation of the Input Collection" stage="str_Itens" />
    </outputs>
    <onsuccess>54d1220a-7e04-4c80-8099-428dd291c5d1</onsuccess>
    <resource object="Utility - Strings" action="Get Collection as CSV" />
  </stage>
  <stage stageid="680ebe97-22a0-488c-9e49-946341ce259e" name="str_Itens" type="Data">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="-195" y="-15" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="80d141ad-3fda-4d9a-8e99-848194a5333c" name="temp" type="Collection">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="-195" y="75" w="120" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e737ed1b-d1cb-407f-8261-d643df94a1b5" name="Delete Column" type="Action">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="90" h="30" />
    <inputs>
      <input type="collection" name="Input Collection" friendlyname="Input Collection" narrative="The collection from which you want to delete a column from" expr="[Lista Documentos]" />
      <input type="text" name="Column Name" friendlyname="Column Name" narrative="The column number to delete" expr="&quot;id&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Output Collection" friendlyname="Output Collection" narrative="A collection with a column removed" stage="temp" />
      <output type="flag" name="Success" friendlyname="Success" stage="" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="" />
    </outputs>
    <onsuccess>6f57a79c-a9d5-4da1-9b44-543a311bd66c</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Delete Column" />
  </stage>
  <stage stageid="54d1220a-7e04-4c80-8099-428dd291c5d1" name="observacao" type="MultipleCalculation">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="105" />
    <onsuccess>c9870965-ada8-4209-ba50-3842c9c827a7</onsuccess>
    <steps>
      <calculation expression="Trim(Replace([str_Itens], &quot;documento,status&quot;, &quot;&quot;))" stage="str_Itens" />
      <calculation expression="Replace([str_Itens], &quot;,&quot;, &quot; : &quot;)" stage="str_Itens" />
      <calculation expression="&quot;Itens: &quot; &amp; NewLine() &amp; [str_Itens]" stage="str_Itens" />
    </steps>
  </stage>
  <stage stageid="491ae75c-1051-4009-a530-e65506e8817d" name="Local Variables" type="Block">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="30" w="150" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="96dc38d1-6726-443d-9ecb-24a41571fd47" name="Output" type="Block">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-45" w="150" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="993300" />
  </stage>
  <stage stageid="fa7d0b3f-bc7e-4aa4-a5aa-a2b1269f1422" name="Recover" type="Recover">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit />
    <display x="90" y="105" />
    <onsuccess>57e1a93a-dd0d-4f29-9bd8-5153ccf52450</onsuccess>
  </stage>
  <stage stageid="57e1a93a-dd0d-4f29-9bd8-5153ccf52450" name="Throw" type="Exception">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <display x="180" y="105" />
    <exception localized="yes" type="" detail="" usecurrent="yes" />
  </stage>
  <stage stageid="9f8dba09-76cf-4a65-b111-67e2c88ce512" name="Message" type="Block">
    <subsheetid>262f4593-de70-4c91-a3fb-13dc05264101</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-105" w="180" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="bf3d1aef-db14-4891-8c4b-cdb84c2a8cd6" name="Note message" type="SubSheet">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="285" y="90" w="90" h="60" />
    <outputs>
      <output type="text" name="observacao" friendlyname="observacao" stage="str_observacao" />
    </outputs>
    <onsuccess>f7f23cb1-3895-486a-8c22-a5439044944c</onsuccess>
    <processid>262f4593-de70-4c91-a3fb-13dc05264101</processid>
  </stage>
  <stage stageid="01c6f7a4-65fd-453e-96ee-4b7bcb580bef" name="str_observacao" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="120" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b53874b4-9085-4b7b-b538-852cc8a54721" name="Block1" type="Block">
    <subsheetid>562f28c5-23b6-4e34-91db-68c96585f0fd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-165" w="240" h="330" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="586139ad-1b61-4d8c-a93c-801bbbaf26bd" name="Set Variables" type="MultipleCalculation">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-150" w="90" h="60" />
    <onsuccess>0c161c34-e0a3-479e-8035-cf593bcd6b5d</onsuccess>
    <steps>
      <calculation expression="FormatDateTime(Now()- MakeTimeSpan(0, 3, 0, 0),&quot;yyyy-MM-dd HH:mm:ss&quot;)" stage="str_endTime" />
      <calculation expression="ToDateTime([str_endTime]) - ToDateTime([str_updateTime])" stage="str_timeExec" />
      <calculation expression="Replace([str_timeExec], &quot;0.&quot;, &quot;&quot;)" stage="str_timeExec" />
    </steps>
  </stage>
  <stage stageid="fcd3bef3-b808-414a-8f03-348b233ef63f" name="str_timeExec" type="Data">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="-90" y="150" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0fe390d8-e142-4beb-97d3-277a3e23d195" name="Update PostgreSQL" type="SubSheet">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="435" y="0" w="90" h="60" />
    <inputs>
      <input type="text" name="StatusJob" friendlyname="StatusJob" expr="&quot;Falha - Negocio&quot;" />
      <input type="text" name="ExecutionTime" friendlyname="ExecutionTime" expr="[str_timeExec]" />
      <input type="text" name="Note" friendlyname="Note" expr="[str_observacao]" />
      <input type="number" name="Status" friendlyname="Status" expr="4" />
    </inputs>
    <onsuccess>30daf867-b858-4376-8f0b-32af55cd1dd9</onsuccess>
    <processid>7d5a12a1-3f3d-4808-a3c4-f619218b2a67</processid>
  </stage>
  <stage stageid="30daf867-b858-4376-8f0b-32af55cd1dd9" name="Anchor8" type="Anchor">
    <subsheetid>7025041b-a2e5-4baa-a406-07c849995dc8</subsheetid>
    <display x="435" y="495" w="10" h="10" />
    <onsuccess>7e5fc446-a081-4136-9320-64a2673ec570</onsuccess>
  </stage>
</process>